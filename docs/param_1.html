

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Input Parameters: IN.PARAM &mdash; QXMD 3.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> QXMD
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="program.html">Program Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="IOf.html">Input/Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="param.html">Input Parameters: IN.PARAM</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QXMD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Input Parameters: IN.PARAM</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/param_1.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="input-parameters-in-param">
<h1>Input Parameters: IN.PARAM<a class="headerlink" href="#input-parameters-in-param" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The name of the main input file (e.g. ‘IN.PARAM’) must be specified in ‘control/filename’.</p>
</div>
<p>The main input file is divided into sections corresponding to different
controls. Sections start with <code class="docutils literal notranslate"><span class="pre">*SECTION_NAME</span></code> and end with <code class="docutils literal notranslate"><span class="pre">*end</span></code>. To
disable any section, simply prepend section title with a <code class="docutils literal notranslate"><span class="pre">#</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">SECTION_NAME_1</span>
<span class="o">...</span>
<span class="o">*</span><span class="n">end</span>

<span class="c1">#*SECTION_NAME_2</span>
<span class="o">...</span>
<span class="o">*</span><span class="n">end</span>
</pre></div>
</div>
<p>Each section is futher divided into subsections, given by a title in
parentheses (e.g. (QM-Nodes)), where input control parameters are
defined. To disable any subsection, simply prepend subsection title with
a ‘#’.</p>
<p>Example: To disable subsection_2 in section *SECTION_NAME</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">SECTION_NAME</span>
<span class="p">(</span><span class="n">subsection_1</span><span class="p">)</span>

<span class="c1">#(subsection_2)</span>

<span class="p">(</span><span class="n">subsection_3</span><span class="p">)</span>
<span class="o">*</span><span class="n">end</span>
</pre></div>
</div>
<p>Note: Any unnecessary sections or subsections may be removed from
input.file, depending on your simulation needs (recommended only for
advanced users).</p>
<div class="section" id="parallel-section-parallel">
<h2>5.1 Parallel Section: *parallel<a class="headerlink" href="#parallel-section-parallel" title="Permalink to this headline">¶</a></h2>
<div class="section" id="qm-nodes">
<h3>5.1.1 (QM-Nodes)<a class="headerlink" href="#qm-nodes" title="Permalink to this headline">¶</a></h3>
<p><strong>npx, npy, npz</strong> = [1|even integer] [1|even integer] [1|even integer]</p>
<p>Default: <strong>npx</strong> = 1 <strong>npy</strong> = 1 <strong>npz</strong> = 1</p>
<p>QM-Nodes is a space delimited set of three integers <strong>npx</strong>, <strong>npy</strong>,
<strong>npz</strong>. <strong>QXMD</strong> uses a hybrid spatial and band decompisition for
parallel computing, and this set of three integers multiplied together
defines the number of MPI ranks. For more detail on parallelization.</p>
</div>
<div class="section" id="k-points">
<h3>5.1.2 (k-points)<a class="headerlink" href="#k-points" title="Permalink to this headline">¶</a></h3>
<p><strong>npk</strong> = [integer]</p>
<p>Default: <strong>npk</strong> = 1</p>
<p>Defines the number of MPI ranks to parallelize k-point sampling. See
section 5.9 for k-point sampling.</p>
</div>
<div class="section" id="linear-response-tddft">
<h3>5.1.3 (linear-response TDDFT)<a class="headerlink" href="#linear-response-tddft" title="Permalink to this headline">¶</a></h3>
<p><strong>nplr</strong> = [integer]</p>
<p>Default: <strong>nplr</strong> = 1</p>
<p>Defines the number of MPI ranks for parallelization of matrix
computations for linear response TDDFT calculations.</p>
</div>
<div class="section" id="md-nodes">
<h3>5.1.4 (MD-nodes)<a class="headerlink" href="#md-nodes" title="Permalink to this headline">¶</a></h3>
<p><strong>md_npx, md_npy, md_npz</strong> = [1|even integer] [1|even integer] [1|even
integer]</p>
<p>MD-Nodes is a space delimited set of three integers: <strong>md_npx, md_npy,
md_npz</strong>. These variables are used only for spatial decomposition in
classical MD and divide-and-conqure QMD simulations. For linear scaling
DFT please see reference <a class="reference external" href="#shimojo_2014">[1-7]</a></p>
</div>
<div class="section" id="reference">
<h3>Reference:<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h3>
<p>1. “A divide-conquer-recombine algorithmic paradigm for large
spatiotemporal quantum molecular dynamics simulations,” F. Shimojo, S.
Hattori, R. K. Kalia, M. Kunaseth, W. Mou, A. Nakano, K. Nomura, S.
Ohmura, P. Rajak, K. Shimamura &amp; P. Vashishta J. Chem. Phys. 140, 18A529
(2014) 2. “Linear-scaling density-functional-theory calculations of
electronic structure based on real-space grids: design, analysis, and
scalability test of parallel algorithms,” F. Shimojo, R. K. Kalia, A.
Nakano &amp; P. Vashishta Comput. Phys. Commun. 140, 303 (2001) 3. “Embedded
divide-and-conquer algorithm on hierarchical real-space grids: parallel
molecular dynamics simulation based on linear-scaling density functional
theory,” F. Shimojo, R. K. Kalia, A. Nakano &amp; P. Vashishta, Comput.
Phys. Commun. 167, 151 (2005) 4. “Divide-and-conquer density functional
theory on hierarchical real-space grids: parallel implementation and
applications,” F. Shimojo, R. K. Kalia, A. Nakano &amp; P. Vashishta, Phys.
Rev. 77 085103 (2008) 5. “Scalable atomistic simulation algorithms for
materials research,” A. Nakano, R. K. Kalia, P. Vashishta, T. J.
Campbell, S. Ogata, F. Shimojo &amp; S. Saini Proc. Supercomputing, SC01
(ACM/IEEE, 2001) 6. “Metascalable quantum molecular dynamics simulations
of hydrogen-on-demand,” K. Nomura, R. K. Kalia, A. Nakano, P. Vashishta,
K. Shimamura, F. Shimojo, M. Kunaseth, P. C. Messina&amp; N. A. Romero Proc.
Supercomputing, SC14 (IEEE/ACM, 2014) 7. “Large nonadiabatic quantum
molecular dynamics simulations on parallel computer,” F. Shimojo, S.
Ohmura, W. Mou, R. K. Kalia, A. Nakano &amp; P. Vashishta Comput. Phys.
Commun. 184, 1 (2013)</p>
</div>
</div>
<div class="section" id="start-on-off-section">
<h2>5.2 Start(on/off) Section<a class="headerlink" href="#start-on-off-section" title="Permalink to this headline">¶</a></h2>
<div class="section" id="on-off">
<h3>5.2.1 (On/Off)<a class="headerlink" href="#on-off" title="Permalink to this headline">¶</a></h3>
<p><strong>lstart</strong> = [boolean]</p>
<p>Default: <strong>lstart</strong> = .FALSE.</p>
<p>.FALSE. : Start self-consistent field (SCF) iteration using a random
initial wavefunction .TRUE. : Continue SCF iteration from a previous
run’s output wavefunction. Note: QM_*??? output files must be present in
the <strong>data/</strong> directory from the previous calculation.</p>
<p>Determines whether you would like to restart a successfully completed
simulation. Note that if you are restarting a NAQMD simulation, you will
also want to set <strong>ltddft_start</strong> to .TRUE. in the *TDDFT-MD section to
properly restart a successfully completed simulation.</p>
</div>
</div>
<div class="section" id="tddft-md">
<h2>5.3 TDDFT-MD<a class="headerlink" href="#tddft-md" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>5.3.1 (On/Off)<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p><strong>ltddft</strong> = [boolean]</p>
<p>Default: <strong>ltddft</strong> = .FALSE.</p>
<p>.FALSE. : Execute Adiabtic QMD based on density functional theory (DFT)
.TRUE. : Execute non-adiabtic QMD (NAQMD) based on time-dependent
density functional theory (TDDFT) <a class="reference external" href="#Gross_1990">[1]</a>.</p>
<p>Determines whether to run QMD simulation under adiabatic or
non-adiabatic methods. Adiabatic methods simulate thermodynamic system
in ground state equilibrium, while non-adiabatic methods simulate
electronic excitations.</p>
</div>
<div class="section" id="fssh">
<h3>5.3.2 (FSSH)<a class="headerlink" href="#fssh" title="Permalink to this headline">¶</a></h3>
<p><strong>ltddft_fssh</strong> = [boolean]</p>
<p>Default: <strong>ltddft_fssh</strong> = .TRUE.</p>
<p>.TRUE. : Perform NAQMD based on Fewest Switches Surface Hopping (FSSH)
method <a class="reference external" href="#Tully_1990">[2]</a> .FALSE. : Perform NAQMD based on based on
Ehrenfest dynamics (not yet implemented).</p>
<p>Determines the implementation method for electron state dynamics in
NAQMD. Fewest Switches surface hopping method is proposed by J. Tully
<a class="reference external" href="#Tully_1990">[2]</a> molecular dynamics simulation of the processes
including electronic transition. Next few flags ask for the
specification of FSSH method</p>
</div>
<div class="section" id="fssh-switch">
<h3>5.3.3 (FSSH-switch)<a class="headerlink" href="#fssh-switch" title="Permalink to this headline">¶</a></h3>
<p><strong>lfssh_switch</strong> = [boolean]</p>
<p>Default: <strong>lfssh_switch</strong> = .TRUE.</p>
<p>.TRUE. : Allow electrons to move between excited states. .FALSE. : Keep
electronic occupations fixed.</p>
<p>Determines whether electronic occupations can change throughout the
NAQMD simulation.</p>
</div>
<div class="section" id="fssh-ground-state-scf">
<h3>5.3.4 (FSSH-ground-state-SCF)<a class="headerlink" href="#fssh-ground-state-scf" title="Permalink to this headline">¶</a></h3>
<p><strong>lfssh_gsscf</strong> = [boolean]</p>
<p>Default: <strong>lfssh_gsscf</strong> = .FALSE.</p>
<p>.TRUE. : SCF iterations performed based on the ground state .FALSE. :
SCF with the excited state</p>
<p>This parameter should always be set to <strong>true</strong> to obtain convergence.</p>
</div>
<div class="section" id="fssh-charge-mixing">
<h3>5.3.5 (FSSH-charge mixing)<a class="headerlink" href="#fssh-charge-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>imxchg_fssh</strong> = 0 | 1 | 2 | 3 <strong>aslh_fssh, bslh_fssh</strong> = [real]
[real]</p>
<p>Default: <strong>imxchg_fssh</strong> = 1</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">imxchg_fssh</th>
<th class="head">Charge Mixing Method                              Notes for aslh_fssh, bslh_fssh</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>0</strong></td>
<td>No Mixing                                         N/A</td>
</tr>
<tr class="row-odd"><td><strong>1</strong></td>
<td>Pulay [<a class="reference external" href="#Pulay_1980">3-</a><a class="reference external" href="#Payne_1992">4</a>] 0.9, 0.6 (recommended values)</td>
</tr>
<tr class="row-even"><td><strong>2</strong></td>
<td>Anderson</td>
</tr>
<tr class="row-odd"><td><strong>3</strong></td>
<td>Simple                                            bslh_fssh not used</td>
</tr>
</tbody>
</table>
<p><strong>imxchg_fssh</strong> is used to specify the method for charge mixing during
SCF iterations, while <strong>aslh_fssh</strong> and <strong>bslh_fssh</strong> are used as tuning
parameters. Note that this section is only considered when
<strong>lfssh_gsscf</strong> is set to .TRUE.</p>
</div>
<div class="section" id="fssh-random-initialize">
<h3>5.3.6 (FSSH-random-initialize)<a class="headerlink" href="#fssh-random-initialize" title="Permalink to this headline">¶</a></h3>
<p><strong>lfssh_random</strong> = [boolean] <strong>rseed_fssh</strong> = [real]</p>
<p>Default: <strong>lfssh_random</strong> = .FALSE.</p>
<p><strong>lfssh_random</strong> = .TRUE. : Automatically seed random number generator.
<strong>lfssh_random</strong> = .FALSE. : Specify the seed for the random number
generator with value given by <strong>rseed_fssh</strong>.</p>
<p>Determines how to specify the seed for the random number generator used
by the FSSH method.</p>
</div>
<div class="section" id="boltzmann-factor-for-upward-transition">
<h3>5.3.7 (Boltzmann factor for upward transition)<a class="headerlink" href="#boltzmann-factor-for-upward-transition" title="Permalink to this headline">¶</a></h3>
<p><strong>lfssh_boltzmn</strong> = [boolean]</p>
<p>Default: <strong>lfssh_boltzmn</strong> = .TRUE.</p>
<p>.TRUE. : Multiply electronic transition probability by the Boltzmann
factor. .FALSE. : Leave electronic transtion probability unaltered.</p>
<p>Determines whether or not to multiply the electronic transition
probability by the Boltzmann factor when the electronic excitation
energy increases due to the transition. This is used in order to
approximately satisfy the detailed balance condition.</p>
</div>
<div class="section" id="velocity-scaling">
<h3>5.3.8 (velocity scaling)<a class="headerlink" href="#velocity-scaling" title="Permalink to this headline">¶</a></h3>
<p><strong>lfssh_vscale</strong> = [boolean] <strong>tminimum</strong> = [real]</p>
<p>Default: <strong>lfssh_vscale</strong> = .FALSE.</p>
<p>.TRUE. : Rescale atomic velocities. .FALSE. : Do not rescae atomic
velocities.</p>
<p>Determines whether or not to rescale atomic velocities upon electronic
excitation. <strong>tminimum</strong> gives the minimum temperature in [K] and is
used to constrain velocity scaling.</p>
</div>
<div class="section" id="time-step">
<h3>5.3.9 (time step)<a class="headerlink" href="#time-step" title="Permalink to this headline">¶</a></h3>
<p><strong>dttddft</strong> = [real]</p>
<p>Default: <strong>dttddft</strong> = 0.02d0</p>
<p>Gives the time step in [a.u.] for numerically integrating the TDDFT
equations.</p>
</div>
<div class="section" id="parallel-calculation">
<h3>5.3.10 (parallel calculation)<a class="headerlink" href="#parallel-calculation" title="Permalink to this headline">¶</a></h3>
<p><strong>lfssh_parallel</strong> = [boolean]</p>
<p>Default: <strong>lfssh_parallel</strong> = .TRUE.</p>
<p>.TRUE. : Solves time-dependent K-S equations in parallel .FALSE. :
Solves time-dependent K-S equations serially.</p>
<p>Determines whether or not to perform TDDFT calculations in parallel.</p>
</div>
<div class="section" id="restart">
<h3>5.3.11 (restart)<a class="headerlink" href="#restart" title="Permalink to this headline">¶</a></h3>
<p><strong>ltddft_start</strong> = [boolean]</p>
<p>Default: <strong>ltddft_start</strong> = .FALSE.</p>
<p>.FALSE. : Initialize electronic occupations as specified in the
(occupations) subsection .TRUE. : Initialize electronic occupations with
their values from the last step of a previously completed simulation.
All files beginning with <a href="#id225"><span class="problematic" id="id226">QM_</span></a>* and <a href="#id227"><span class="problematic" id="id228">MD_</span></a>* must be present in the
<strong>data/</strong> directory.</p>
<p>Determines how to initialize electronic excitations for an NAQMD
simulation. Note that if you are continuing a calculation by setting
<strong>lstart</strong> to .TRUE. in the *start(on/off), you usually want
<strong>ltddft_start</strong> to be set to .TRUE. as well to properly restart a
successfully completed simulation.</p>
</div>
<div class="section" id="initial-exciton">
<h3>5.3.12 (initial exciton)<a class="headerlink" href="#initial-exciton" title="Permalink to this headline">¶</a></h3>
<p><strong>nexciton</strong> = [integer] <strong>iband_hole, iband_electron, ldegenerate</strong> =
[integer] [integer] [boolean]</p>
<p>Default: <strong>nexciton</strong> = 0</p>
<p><strong>nexciton</strong> = total number of excitons <strong>iband_hole</strong> = band index of
the hole. <strong>iband_electron</strong> = band index of the electron.
<strong>ldegenerate</strong> = .TRUE. : triplet <strong>ldegenerate</strong> = .FALSE. : singlet</p>
<p>This set of variables are used to define an exciton in linear-reponse
TDDFT. Thus, these variables are only read when <strong>lrtddft</strong> is set to
.TRUE. in the *linear-response TDDFT section.</p>
<p><strong>nexciton</strong> gives the total number of excitons to be initially created
and should be followed by that many lines of space delimted values for
<strong>iband_hole, iband_electron, ldegenerate</strong>, where each set specifies
one exciton. <strong>nexciton</strong> should be only be set to 0 or 1, as higher
numbers of excitons is not gaurenteed to work.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">initial</span> <span class="n">exciton</span><span class="p">)</span>
    <span class="mi">1</span>
    <span class="mi">10</span>  <span class="mi">11</span>  <span class="o">.</span><span class="n">FALSE</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="ground-state-force">
<h3>5.3.13 (ground state force)<a class="headerlink" href="#ground-state-force" title="Permalink to this headline">¶</a></h3>
<p><strong>lfssh_gsfrc</strong> = [boolean]</p>
<p>Default: <strong>lfssh_gsfrc</strong> = .FALSE.</p>
<p>.TRUE. : ground state forces are used in FSSH .FALSE. : the excited
state forces are used.</p>
<p>Note that this variable is only read if <strong>lfssh_gsscf</strong> is set to .TRUE.
in the (FSSH-ground-state-SCF) subsection.</p>
</div>
<div class="section" id="nsc-force">
<h3>5.3.14 (NSC force)<a class="headerlink" href="#nsc-force" title="Permalink to this headline">¶</a></h3>
<p><strong>ltddft_nscforce</strong> = [boolean]</p>
<p>Default: <strong>ltddft_nscforce</strong> = .TRUE.</p>
<p>.TRUE. : On .FALSE.: Off</p>
<p>Determines whether or not to calculate excited state forces using a
non-self-consistent (NSC) method.</p>
</div>
<div class="section" id="occupations">
<h3>5.3.15 (occupations)<a class="headerlink" href="#occupations" title="Permalink to this headline">¶</a></h3>
<p><strong>nocc_change</strong> = [integer] <strong>num_band, occ_new</strong> = [integer] [real]
[real]</p>
<p><strong>nocc_change</strong> = total number of bands with electronic occupation
number to be changed. <strong>num_band</strong> = band index for occupation change.
<strong>occ_new</strong> = new occupation number for the corresponding band for up
(and down) electrons.</p>
<p><strong>nocc_change</strong> gives the total number of bands that will undergo a
change in electronic occupation number and should be followed by that
many lines of space delimted values for <strong>num_band, occ_new</strong>, where
each set specifies the band index undergoing a change in its electron
occupation values. If not using spin polarization, only the first number
in the <strong>occ_new</strong> varibale will be read. If using spin-polarization,
you must set <strong>lspin</strong> to .TRUE. in the *spin polarization section,
then, you may specify the number of up electrons to move with the first
number in the <strong>occ_new</strong> varibale set and the number of down electrons
to move with the second number in the <strong>occ_new</strong> varibale set.</p>
<p>Example for no spin-polarization: This example shows how to excited both
electrons in band index 10 and both electrons in band index 11, to band
indices 12 and 13 (four total electrons changing occupation). This
assumes that in the ground state band indicies 10 and 11 are fully
occupied and band indices 12 and 13 are empty.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">occupations</span><span class="p">)</span>
<span class="mi">4</span>
<span class="mi">10</span>   <span class="mf">0.0</span>   <span class="mf">0.0</span>
<span class="mi">11</span>   <span class="mf">0.0</span>   <span class="mf">0.0</span>
<span class="mi">12</span>   <span class="mf">2.0</span>   <span class="mf">0.0</span>
<span class="mi">13</span>   <span class="mf">2.0</span>   <span class="mf">0.0</span>
</pre></div>
</div>
<p>Example for spin-polarization: This example shows how to excite the up
electron in band index 10 and the down electron in band index 11 to band
indices 12 and 13, respectively (two total electrons changing
occupation). This assumes that in the ground state band indicies 10 and
11 are fully occupied and band indices 12 and 13 are empty.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">occupations</span><span class="p">)</span>
<span class="mi">2</span>
<span class="mi">10</span>   <span class="mf">0.0</span>   <span class="mf">1.0</span>
<span class="mi">11</span>   <span class="mf">1.0</span>   <span class="mf">0.0</span>
<span class="mi">12</span>   <span class="mf">1.0</span>   <span class="mf">0.0</span>
<span class="mi">13</span>   <span class="mf">0.0</span>   <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<div class="section" id="broadening">
<h3>5.3.16 (broadening)<a class="headerlink" href="#broadening" title="Permalink to this headline">¶</a></h3>
<p><strong>tdbroad</strong> = [real]</p>
<p>Default: <strong>tdbroad</strong> = 0.0</p>
<p>Determines the width of Gaussian broadening of the Fermi surface in [K].
Note: <strong>tdbroad</strong> = 0.0 denotes no broadening.</p>
</div>
<div class="section" id="dish">
<h3>5.3.17 (DISH)<a class="headerlink" href="#dish" title="Permalink to this headline">¶</a></h3>
<p><strong>lfssh_dish</strong> = [boolean] <strong>ndishpair</strong> = [integer] <strong>ndishi, ndishj,
decoherence_rate</strong> = [integer] [integer] [real]</p>
<p>Default: <strong>lfssh_dish</strong> = .FALSE. <strong>ndishpair</strong> = 0</p>
<p><strong>lfssh_dish</strong> = .TRUE. : Enables Decoherence-Induced Surface Hopping
(DISH) <strong>lfssh_dish</strong> = .FALSE. : Disables DISH <strong>ndishpair</strong> = the
number of state pairs <strong>ndishi, ndishj, decoherence_rate</strong> = the two
band indices between which to define the decoherence rate in [a.u.] for
DISH</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">DISH</span><span class="p">)</span>
 <span class="o">.</span><span class="n">true</span><span class="o">.</span>
   <span class="mi">6</span>
   <span class="mi">23</span>   <span class="mi">24</span>  <span class="mf">5.063109E-03</span>
   <span class="mi">23</span>   <span class="mi">25</span>  <span class="mf">5.147713E-03</span>
   <span class="mi">23</span>   <span class="mi">26</span>  <span class="mf">4.596093E-03</span>
   <span class="mi">24</span>   <span class="mi">25</span>  <span class="mf">7.877069E-03</span>
   <span class="mi">24</span>   <span class="mi">26</span>  <span class="mf">7.426337E-03</span>
   <span class="mi">25</span>   <span class="mi">26</span>  <span class="mf">2.768402E-03</span>
</pre></div>
</div>
<p>The decoherence rate for each pair of states is given by
<a class="reference external" href="#Jaeger_2012">[5]</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rate</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span>
</pre></div>
</div>
<p>where alpha is a parameter of gaussian</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gaus</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p>which is fitted to the dephasing function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dij</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">gij</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
<p>with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gij</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="nb">int</span><span class="o">^</span><span class="n">t_0</span> <span class="n">intg</span><span class="p">(</span><span class="n">t</span><span class="s1">&#39;) dt&#39;</span>
</pre></div>
</div>
<p>and</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">g</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">int_t</span><span class="o">^</span><span class="mi">0</span> <span class="n">Cij</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
<p>Cij(t) is an autocorrelation function of the energy gap between two
states</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cij</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="o">&lt;</span><span class="p">(</span><span class="n">Eij</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="n">Eij_ave</span><span class="p">)(</span><span class="n">Eij</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">-</span><span class="n">Eij_ave</span><span class="p">)</span><span class="o">&gt;</span>
       <span class="o">=</span> <span class="o">&lt;</span><span class="p">(</span><span class="n">Eij</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">Eij</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">-</span> <span class="n">Eij_ave</span><span class="o">*</span><span class="n">Eij_ave</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">where</span> <span class="n">Eij</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">Ei</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">Ej</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Reference:<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>1. “Time-dependent density-functional theory”, Gross, E. K. U., and W.
Kohn. Adv. Quantum Chem. 21, 255-291, (1990) 2.”Molecular dynamics with
electronic transitions.” Tully, John C. J. Chem. Phys. 93.2, 1061-1071
(1990) 3.”Convergence acceleration of iterative sequences. the case of
scf iteration.” Pulay, P Chem. Phys. Lett. 72.3, 393-398 (1980)
4.”Iterative minimization techniques for ab initio total-energy
calculations: molecular dynamics and conjugate gradients” Payne, M. C.,
Teter, M. P., Allan, D. C. ,Arias, T. A., and Joannapoulos, J. D. Rev.
Mod. Phys. 64, 1045 (1992) 5. “Decoherence-induced surface hopping.”
Jaeger, H. M., Fischer, S., &amp; Prezhdo, O. V. J. Chem. Phys. 137, 22A545
(2012)</p>
</div>
</div>
<div class="section" id="id3">
<h2>5.4 linear-response TDDFT<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id4">
<h3>5.4.1 (On/Off)<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p><strong>lrtddft</strong> = [boolean]</p>
<p>Default: <strong>lrtddft</strong> = .FALSE.</p>
<p>.TRUE. : Execute NAQMD based on linear response time-dependent density
functional theory (LR-TDDFT) <a class="reference external" href="#Casida_1995">[1]</a> .FALSE. : Do not use
linear response theory for NAQMD.</p>
<p>Determines whether or not to use linear reponse theory, which involves
calculation the Casida coupling matrix, for NAQMD simulations. For more
detail, please see paper by Casida et al. <a class="reference external" href="#Casida_1995">[1]</a></p>
</div>
<div class="section" id="whether-to-specify-states">
<h3>5.4.2 (whether to specify states)<a class="headerlink" href="#whether-to-specify-states" title="Permalink to this headline">¶</a></h3>
<p><strong>lrspecific</strong> = [boolean]</p>
<p>Default: <strong>lrspecific</strong> = .FALSE.</p>
<p>.TRUE. : Specify the occupied and unoccupied electronic states to be
considered in the (specific states) subsection. .FALSE. : Specify the
occupied and unoccupied electronic states to be considered in the
(energy difference) subsection.</p>
<p>Determines how the occupied and unoccupied states to be considered in
the linear response TDDFT calculations. When <strong>lrspecific</strong> is set to
.TRUE. the occupied and unoccupied electronic states should be specified
in the (specific states) subsection by their band index numbers. When
<strong>lrspecific</strong> is set to .FALSE. the occupied and unoccupied electronic
states should be specified in the (energy difference) subsection by
giving the maximum energy difference between them.</p>
</div>
<div class="section" id="specific-states">
<h3>5.4.3 (specific states)<a class="headerlink" href="#specific-states" title="Permalink to this headline">¶</a></h3>
<p><strong>nlrstates</strong> = [boolean]</p>
<p><strong>ihole, iparticle, ispin, ikpts</strong> = [integer] [integer] [integer]
[integer] OR <strong>ihband, ipband</strong> = [integer] [integer]</p>
<p>Default: <strong>nlrstates</strong> = 0 <strong>ihband</strong> = 0 <strong>ipband</strong> = 0</p>
<p><strong>nlrstates</strong> = the number of states to specify <strong>ihole</strong> = band index
of hole (occupied states) <strong>iparticle</strong> = band index of particle
(unoccupied states) <strong>ispin</strong> = spin index (1 or 2) <strong>ikpts</strong> = k-point
index <strong>ihband</strong> = band index of hole (occupied states) <strong>ipband</strong> =
band index of particle (unoccupied states)</p>
<p>If <strong>nlrstates</strong> &gt; 0, then states are specified with <strong>ihole, iparticle,
ispin, ikpts</strong>. If <strong>nlrstates</strong> = 0, then states are specified with
<strong>ihband, ipband</strong>, where states between <strong>ihband</strong> and <strong>ipband</strong> will
be considered. Note that this subsection is only read if <strong>lrspecific</strong>
is set to .TRUE. in the (whether to specify states) subsection.</p>
</div>
<div class="section" id="unit-of-energy">
<h3>5.4.4 (unit of energy)<a class="headerlink" href="#unit-of-energy" title="Permalink to this headline">¶</a></h3>
<p>(ry) or (hr) or (ev)</p>
<p>Default: (ry)</p>
<p>The units of energy to be used for the variable <strong>enediff</strong> given below.</p>
</div>
<div class="section" id="energy-difference">
<h3>5.4.5 (energy difference)<a class="headerlink" href="#energy-difference" title="Permalink to this headline">¶</a></h3>
<p><strong>enediff</strong> = [real]</p>
<p>Default: <strong>enediff</strong> = 0.3</p>
<p><strong>enediff</strong> = the maximum energy difference in the units given above
between occupied and unoccupied states considered in linear response
TDDFT. Note that this subsection is only read if <strong>lrspecific</strong> is set
to .FALSE. in the (whether to specify states) subsection.</p>
</div>
<div class="section" id="finite-difference-mesh">
<h3>5.4.6 (finite-difference mesh)<a class="headerlink" href="#finite-difference-mesh" title="Permalink to this headline">¶</a></h3>
<p><strong>fdmeshxc</strong> = [real]</p>
<p>Default: <strong>fdmeshxc</strong> = 1.d-06</p>
<p><strong>fdmeshxc</strong> is the finite difference mesh size for the 2nd derivative
of Exc</p>
</div>
<div class="section" id="threshold">
<h3>5.4.7 (threshold)<a class="headerlink" href="#threshold" title="Permalink to this headline">¶</a></h3>
<p><strong>threshrpa</strong> = [real]</p>
<p>Default: <strong>threshrpa</strong> = 0.0</p>
<p><strong>threshrpa</strong> is the threshold value for RPA1</p>
</div>
<div class="section" id="transition-dipole-threshold">
<h3>5.4.8 (transition-dipole threshold)<a class="headerlink" href="#transition-dipole-threshold" title="Permalink to this headline">¶</a></h3>
<p><strong>threshdipole</strong> = [real]</p>
<p>Default: <strong>threshdipole</strong> = 0.0</p>
<p><strong>threshdipole</strong> threshold value for transition dipole.</p>
</div>
<div class="section" id="energy-difference-threshold">
<h3>5.4.9 (energy-difference threshold)<a class="headerlink" href="#energy-difference-threshold" title="Permalink to this headline">¶</a></h3>
<p><strong>threshexcite</strong> = [real]</p>
<p>Default: <strong>threshexcite</strong> = 1.d-04</p>
<p><strong>threshexcite</strong> is the threshold value for the difference between the
energies of hole and particle</p>
</div>
<div class="section" id="long-range-exchange-scheme">
<h3>5.4.10 (long-range exchange scheme)<a class="headerlink" href="#long-range-exchange-scheme" title="Permalink to this headline">¶</a></h3>
<p><strong>llcexchange</strong> = [boolean]</p>
<p>Default: <strong>llcexchange</strong> = .FALSE.</p>
<p>.TRUE. : Use long-range correction for exchange. .FALSE. : Do not use.</p>
<p>Determines whether or not to use the long-range correction for exchange
functional <a class="reference external" href="#Tawada_2004">[2]</a>. Note that if <strong>lvacuum[1|2|3]</strong> is
set to .TRUE. <strong>alpha_ldouble_grid_recip</strong> needs to be specified to
determine the ratio of the long-range part.</p>
</div>
<div class="section" id="parameters-to-divide-1-r">
<h3>5.4.11 (parameters to divide 1/r)<a class="headerlink" href="#parameters-to-divide-1-r" title="Permalink to this headline">¶</a></h3>
<p><strong>alpha_llcexchange</strong> = [real] <strong>large_cell_llcexchange</strong> = [real]</p>
<p>Default: <strong>alpha_llcexchange</strong> = 0.17 <strong>large_cell_llcexchange</strong> = 2.0</p>
<p>Note 1: The cell-vector length of the CUBIC large cell is given by
large_cell_llcexchange * max(L1,L2,L3). Note 2: (iosp) &amp; (ecutlong)
have to be set in *double-grid method only if llcexchange &amp;
.not.ldouble_grid_recip</p>
</div>
<div class="section" id="hybrid-mixing-parameter">
<h3>5.4.12 (hybrid mixing parameter)<a class="headerlink" href="#hybrid-mixing-parameter" title="Permalink to this headline">¶</a></h3>
<p><strong>hybrid_mixing</strong> = [real]</p>
<p>Default: <strong>hybrid_mixing</strong> = 0.0</p>
<p><strong>hybrid_mixing</strong> is the mixing paramter for the Hybrid method. Note
that this is only read when <strong>llcexchange</strong> is set to .FALSE.</p>
</div>
<div class="section" id="foerster-width-of-gaussian">
<h3>5.4.13 (Foerster: width of Gaussian)<a class="headerlink" href="#foerster-width-of-gaussian" title="Permalink to this headline">¶</a></h3>
<p><strong>foersigma</strong> = [real]</p>
<p>Default: <strong>foersigma</strong> = 0.1d0</p>
<p><strong>foersigma</strong> gives the Foerster transfer rate</p>
</div>
<div class="section" id="diagonal-approximation">
<h3>5.4.14 (diagonal approximation)<a class="headerlink" href="#diagonal-approximation" title="Permalink to this headline">¶</a></h3>
<p><strong>ldiagonal</strong> = [boolean]</p>
<p>Default:</p>
<p><strong>ldiagonal</strong> = .TRUE.</p>
<p>.TRUE. : The diagonal approximation is made, where matrix elements are
calculated only for <strong>ihole_1 == ihole_2</strong> and <strong>iparticle_1 ==
iparticle_2</strong> .FALSE. : Diagonal approximation is not used.</p>
<p>Determines whether or not to use the diagonal approximation. Note: If
<strong>ltddft</strong> is set to .TRUE. .and. <strong>ltddft_fssh</strong> is also set to .TRUE.,
set <strong>ldiagonal</strong> equal to .TRUE.</p>
</div>
<div class="section" id="scissors-correction">
<h3>5.4.15 (scissors correction)<a class="headerlink" href="#scissors-correction" title="Permalink to this headline">¶</a></h3>
<p><strong>lscissors_lrtddft</strong> = [boolean] <strong>ecorr_triplet</strong> = [real]
<strong>ecorr_singlet</strong> = [real]</p>
<p>Default: <strong>lscissors_lrtddft</strong> = .FALSE.</p>
<p><strong>lscissors_lrtddft</strong> = .TRUE. : Implement scissors correction.
<strong>lscissors_lrtddft</strong> = .FALSE. : Do no implement correction.</p>
<p>Note: The values for <strong>ecorr_triplet</strong> and <strong>ecorr_singlet</strong> depend on
‘unit of energy’ in the *linear-response TDDFT section. These
corrections will be added to the excitation energies.</p>
</div>
<div class="section" id="singlet-fission-rate-calculation">
<h3>5.4.16 (singlet-fission-rate calculation)<a class="headerlink" href="#singlet-fission-rate-calculation" title="Permalink to this headline">¶</a></h3>
<p><strong>lfission_rate</strong> = [boolean]</p>
<p>Default: <strong>lfission_rate</strong> = .FALSE.</p>
<p>.TRUE. : Calculate the singlet fission rate based on time-dependent
perturbation theory. .FALSE. : Do not calculate rate.</p>
</div>
<div class="section" id="spontaneous-emission-rate">
<h3>5.4.17 (spontaneous emission rate)<a class="headerlink" href="#spontaneous-emission-rate" title="Permalink to this headline">¶</a></h3>
<p><strong>lemission_rate</strong> = [boolean] <strong>refractive</strong> = [real]</p>
<p>Default: <strong>lemission_rate</strong> = .TRUE. <strong>refractive</strong> = 1.5</p>
<p><strong>lemission_rate</strong> = .TRUE. : Compute spontaneous emission rate based on
transition dipole approximation. <strong>lemission_rate</strong> = .FALSE. : Do not
calculate rate.</p>
<p>Determines whether or not to calculate spontaneous emission rate.
<strong>refractive</strong> is the refractive index of the system.</p>
</div>
<div class="section" id="id5">
<h3>Reference:<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>1. “Time-Dependent Density Functional Response Theory for Molecules” M.
E. Casida, Recent Advances in Density Functional Methods (Part I),
edited by D. P. Chong (World Scientific, Singapore, pp. 155-192 (1995))
2. “A long-range-corrected time-dependent density functional theory.”
Tawada, Yoshihiro, et al. J. Chem. Phys. 120, 8425-8433 (2004)</p>
</div>
</div>
<div class="section" id="paw">
<h2>5.5 PAW<a class="headerlink" href="#paw" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id6">
<h3>5.5.1 (On/Off)<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p><strong>lpaw</strong> = [boolean]</p>
<p>Default: <strong>lpaw</strong> = .FALSE.</p>
<p>.TRUE. : Use the PAW method <a class="reference external" href="#Blochl_1994">[1]</a> .FALSE.: Use other
pseudopotential method.</p>
</div>
<div class="section" id="non-spherical-symmetry">
<h3>5.5.2 (non-spherical symmetry)<a class="headerlink" href="#non-spherical-symmetry" title="Permalink to this headline">¶</a></h3>
<p><strong>lpaw_sym</strong> = [boolean]</p>
<p>Default: <strong>lpaw_sym</strong> = .FALSE.</p>
<p>.TRUE. : Full symmetry .FALSE. : Spherical symmetry</p>
</div>
<div class="section" id="onsite-charge-mixing">
<h3>5.5.3 (onsite charge mixing)<a class="headerlink" href="#onsite-charge-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>paw_mix</strong> = [real]</p>
<p>Default: <strong>paw_mix</strong> = 0.5</p>
<p>Gives the onsite charge mixing parameter in the PAW method.</p>
</div>
<div class="section" id="id7">
<h3>Reference:<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>1. “Projector augmented-wave method” P. E. Blochl Phys Rev B 50, 17953
(1994)</p>
</div>
</div>
<div class="section" id="cluster">
<h2>5.6 Cluster<a class="headerlink" href="#cluster" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id8">
<h3>5.6.1 (On/Off)<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p><strong>lclust</strong> = [boolean]</p>
<p>Default: <strong>lclust</strong> = .FALSE.</p>
<p>.TRUE. : Perform cluster calculation. .FALSE. : Perform bulk
calculation.</p>
<p>Determines whether to perform a cluster or bulk calculation.</p>
</div>
</div>
<div class="section" id="approximation-for-exchange">
<h2>5.7 Approximation for Exchange<a class="headerlink" href="#approximation-for-exchange" title="Permalink to this headline">¶</a></h2>
<div class="section" id="approximation">
<h3>5.7.1 (approximation)<a class="headerlink" href="#approximation" title="Permalink to this headline">¶</a></h3>
<p><strong>jgga</strong> = 1|2|3|4|5|6</p>
<p>Default: <strong>jgga</strong> = 2</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>jgga</strong></th>
<th class="head">Excahnge functional</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>1</strong></td>
<td>LD<a class="reference external" href="#Perdew_1981">[1]</a></td>
</tr>
<tr class="row-odd"><td><strong>2</strong></td>
<td>GGA(PBE)<a class="reference external" href="#Perdew_1996">[2]</a></td>
</tr>
<tr class="row-even"><td><strong>3</strong></td>
<td>GGA(RPBE)<a class="reference external" href="#Hammer_1999">[3]</a></td>
</tr>
<tr class="row-odd"><td><strong>4</strong></td>
<td>GGA(revPBE)<a class="reference external" href="#Zhang_1998">[4]</a></td>
</tr>
<tr class="row-even"><td><strong>5</strong></td>
<td>vdW-DF<a class="reference external" href="#Dion_2004">[5]</a></td>
</tr>
<tr class="row-odd"><td><strong>6</strong></td>
<td>vdW-DF2 <a class="reference external" href="#Lee_2010">[6]</a></td>
</tr>
</tbody>
</table>
<p><strong>jgga</strong> is used to specify the exchange correction functional.</p>
</div>
<div class="section" id="dft-d">
<h3>5.7.2 (DFT-D)<a class="headerlink" href="#dft-d" title="Permalink to this headline">¶</a></h3>
<p><strong>ldftd</strong> = [boolean]</p>
<p>Default: <strong>ldftd</strong> = .FALSE.</p>
<p>.TRUE. : Employ an empirical vdW correction .FASLE. : Do not use an
empirical vdW correction</p>
<p>Determines whether to use an empirical correction for the van der Waals
interaction proposed by S. Grimme <a class="reference external" href="#grimme_2006">[7]</a></p>
</div>
<div class="section" id="kernel-factorization-jgga-5-or-6-vdw-df-or-vdw-df2">
<h3>5.7.3 (kernel factorization) —— jgga=5 or 6 (vdW-DF or vdW-DF2)<a class="headerlink" href="#kernel-factorization-jgga-5-or-6-vdw-df-or-vdw-df2" title="Permalink to this headline">¶</a></h3>
<p><strong>lvdw_factorize</strong> = [boolean]</p>
<p>Default: <strong>lvdw_factorize</strong> = .FALSE.</p>
<p>.TRUE. : Take into account. .FASLE. : Do not</p>
<p>only used for for vdW-DF or vdW-DF2 (jgga=5 or 6 )</p>
</div>
<div class="section" id="q-mesh-range-jgga-5-or-6-vdw-df-or-vdw-df2">
<h3>5.7.4 (q-mesh range) —— jgga=5 or 6 (vdW-DF or vdW-DF2)<a class="headerlink" href="#q-mesh-range-jgga-5-or-6-vdw-df-or-vdw-df2" title="Permalink to this headline">¶</a></h3>
<p><strong>lvdw_factorize</strong> = [boolean] <strong>q_cut</strong> = [real] <strong>dlambda</strong> = [real]
<strong>nqmesh</strong> = [integer]</p>
<p>Default: <strong>q_cut</strong> = 5.0 <strong>dlambda</strong> = 1.2 <strong>nqmesh</strong> = 20</p>
<p>These parameters are used to saturate the original function q_0(n,|Delta
n|) by redefining q_0^{sat} = h[q_0,q_c].</p>
<p>h(x,x_c) = x_c[1 - exp( - sum_{m=1}^{m_c} (x/x_c)^m/m)]</p>
<p><strong>q_cut</strong> is corresponding to q_c and <strong>dlambda</strong> and <strong>nqmesh</strong> are a
width and the number of a logarithmic mesh.</p>
</div>
<div class="section" id="kernel-cutoff-parameters-jgga-5-or-6-vdw-df-or-vdw-df2">
<h3>5.7.5 (kernel cutoff parameters) —— jgga=5 or 6 (vdW-DF or vdW-DF2)<a class="headerlink" href="#kernel-cutoff-parameters-jgga-5-or-6-vdw-df-or-vdw-df2" title="Permalink to this headline">¶</a></h3>
<p><strong>d_soft</strong> = [real] <strong>phi_at_0</strong> = [real]</p>
<p>Default: <strong>d_soft</strong> = 1.0 <strong>phi_at_0</strong> = 0.5</p>
<p>Because the kernel phi(d_1,d_2) has a logarithmic divergence when d_1
and d_2 tend to zero, the modified kernel is used for small d_1 and d_2:</p>
<p>phi(d_1,d_2) = phi_0 + phi_2 d^2 + phi_4 d^4 (d &lt; d_s)</p>
<p>where d = sqrt(d_1^2 + d_2^2) and phi_2 and phi_4 are fitting
parameters. d_s and phi_0 are corresponding to <strong>d_soft</strong> and
<strong>phi_at_0</strong></p>
</div>
<div class="section" id="cutoff-length-lvdw-factorize-false">
<h3>5.7.6 (cutoff length) —— lvdw_factorize = .FALSE.<a class="headerlink" href="#cutoff-length-lvdw-factorize-false" title="Permalink to this headline">¶</a></h3>
<p><strong>rvdwmax</strong> = [real]</p>
<p>Default: <strong>rvdwmax</strong> = 10.d0</p>
<p>Cutoff length in [a.u]</p>
</div>
<div class="section" id="integration-skip-lvdw-factorize-false">
<h3>5.7.7 (integration skip) —— lvdw_factorize = .FALSE.<a class="headerlink" href="#integration-skip-lvdw-factorize-false" title="Permalink to this headline">¶</a></h3>
<p><strong>imod1</strong> = [even integer] <strong>imod2</strong> = [integer]</p>
<p>Default: <strong>imod1</strong> = 2 <strong>imod2</strong> = 3</p>
<p>Integration of r’ on every <strong>imod1</strong> meshes Integration of r on every
<strong>imod2</strong> meshes</p>
</div>
<div class="section" id="order-of-cardinal-b-spline-lvdw-factorize-false">
<h3>5.7.8 (order of cardinal B spline) —— lvdw_factorize = .FALSE.<a class="headerlink" href="#order-of-cardinal-b-spline-lvdw-factorize-false" title="Permalink to this headline">¶</a></h3>
<p><strong>iosp</strong> = [odd integer]</p>
<p>Default: <strong>iosp</strong> = 7</p>
<p>order of cardinal B spline in the double-grid method
<a class="reference external" href="#Martyna_1999">[8]</a></p>
</div>
<div class="section" id="dft-u">
<h3>5.7.9 (DFT+U)<a class="headerlink" href="#dft-u" title="Permalink to this headline">¶</a></h3>
<p><strong>lplusU</strong> = [boolen]</p>
<p>Default: <strong>lplusU</strong> = .FALSE.</p>
<p>.TRUE. : Employ DFT+U correction of the mean-field Hubbard model .FASLE.
: Do not use DFT+U correction Determines whether to use DFT+U correction
of the mean-field Hubbard model <a class="reference external" href="Dudarev_1998">[9]</a>. The value of U
and J parameter is set to in the *atoms section. Note that this
subsection is only considered when <strong>lpaw</strong> is set to .TRUE.</p>
</div>
<div class="section" id="id9">
<h3>5.7.10 (onsite charge mixing)<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p><strong>plusU_mix</strong> = [real]</p>
<p>Default: <strong>plusU_mix</strong> = 0.5</p>
<p><strong>plusU_mix</strong> is used as turning parameter for onsite charge mixing.
Note that this subsection is only considered when both <strong>lpaw</strong> and
<strong>lplusU</strong> are set to .TRUE.</p>
</div>
<div class="section" id="dft-c">
<h3>5.7.11 (DFT+C)<a class="headerlink" href="#dft-c" title="Permalink to this headline">¶</a></h3>
<p><strong>lplusC</strong> = [boolen]</p>
<p>Default: <strong>lplusC</strong> = .FALSE.</p>
<p>.TRUE. : Employ an empirical correction to non-local pseudopotential
<a class="reference external" href="#Li_2005">[10]</a> .FASLE. : Do not</p>
</div>
<div class="section" id="hybrid-functional">
<h3>5.7.12 (hybrid functional)<a class="headerlink" href="#hybrid-functional" title="Permalink to this headline">¶</a></h3>
<p><strong>jhybrid</strong> = [0|1]</p>
<p>Default: <strong>jhybrid</strong> = 0</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>jhybrid</strong></th>
<th class="head">Hybrid functional</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>0</strong></td>
<td>Do not use</td>
</tr>
<tr class="row-odd"><td><strong>1</strong></td>
<td>HSE <a class="reference external" href="#Heyd_2003">[11-13]</a></td>
</tr>
</tbody>
</table>
<p><strong>jhybrid</strong> is used to specify the range-separated hybrid exchange
functionals. Note that this subsection is only considered when <strong>jgga</strong>
is set to 2(GGA(PBE)).</p>
</div>
<div class="section" id="id10">
<h3>5.7.13 (hybrid mixing parameter)<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p><strong>hmixing</strong> = [real]</p>
<p>Default: <strong>hmixing</strong> = 0.25</p>
<p>The HSE exchange correlation functional is constructed as a linear
combination of the Hartree-Fock exact exchange functional and PBE
functional:</p>
<p>Exc^HSE = a Ex^HF + (1-a) Ex^PBE-SR + Ex^PBE-LR + Ec^PBE</p>
<p>where <strong>a</strong> is defined by <strong>hmixing</strong>.</p>
</div>
<div class="section" id="range-separation-parameter">
<h3>5.7.14 (range-separation parameter)<a class="headerlink" href="#range-separation-parameter" title="Permalink to this headline">¶</a></h3>
<p><strong>hrange</strong> = [real]</p>
<p>Default: <strong>hrange</strong> = 0.11</p>
<p>The HSE exchange correlation functional spits the Coulomb operator into
short-range and long-range components by an error function and
<strong>hrange</strong>, omega is an adjustable parameter:</p>
<p>1/r = erfc(omega r)/r + erf(omega r)/r</p>
</div>
<div class="section" id="grid-reduction-factor">
<h3>5.7.15 (grid-reduction factor)<a class="headerlink" href="#grid-reduction-factor" title="Permalink to this headline">¶</a></h3>
<p><strong>mgridred</strong> = [integer]</p>
<p>Default: <strong>mgridred</strong> = 1</p>
<p><strong>mgridred</strong> gives the grid-reduction factor. Note: The number of
k-point grids should be the multiple of <strong>mgridred</strong>.</p>
</div>
<div class="section" id="id11">
<h3>Reference:<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>1. “Self-interaction correction to density-functional approximations for
many-electron systems” J. P. Perdew and Alex Zunger Phys. Rev. B 23 ,
5048(1981) 2. “Generalized Gradient Approximation Made Simple” J. P.
Perdew, K. Burke and M. Ernzerhof Phys. Rev. Lett. 78, 3865 (1996) 3.
“Improved adsorption energetics within density-functional theory using
revised Perdew-Burke-Ernzerhof functionals” B. Hammer, L. B. Hansen, and
J. K. Nørskov Phys. Rev. B 59, 7413 (1999) 4. “Comment on “Generalized
Gradient Approximation Made Simple” ” Yingkai Zhang and Weitao Yang
Phys. Rev. Lett. 80, 890 (1998) 5. “Van der Waals Density Functional for
General Geometries ” M. Dion, H. Rydberg, E. Schröder, D. C. Langreth,
and B. I. Lundqvist Phys. Rev. Lett. 92, 246401 (2004) 6.
“Higher-accuracy van der Waals density functional” Kyuho Lee, Éamonn D.
Murray, Lingzhu Kong, Bengt I. Lundqvist, and David C. Langreth Phys.
Rev. B 82, 081101 (2010) 7. “Semiempirical GGA‐type density functional
constructed with a long‐range dispersion correction” Stefan Grimme J.
Comput. Chem. 27, 1787 (2006) 8. “A reciprocal space based method for
treating long range interactions in ab initio and force-field-based
calculations in clusters” J. Chem. Phys. 110, 2810 (1990) 9.
“Electron-energy-loss spectra and the structural stability of nickel
oxide:  An LSDA+U study” Phys. Rev. B 57, 1505 (1998) 10.
“Band-structure-corrected local density approximation study of
semiconductor quantum dots and wires” Phys. Rev. B 72, 125325 (2005) 11.
“Hybrid functionals based on a screened Coulomb potential.” J. Heyd and
G. E. ScuseriaJ. Chem. Phys. 118, 8207-8215 (2003) 12. “Efficient hybrid
density functional calculations in solids: Assessment of the
Heyd–Scuseria–Ernzerhof screened Coulomb hybrid functional ” J. Heyd and
G. E. ScuseriaJ. Chem. Phys. 121, 1187 (2004) 13. “Influence of the
exchange screening parameter on the performance of screened hybrid
functionals ” A.V. Krukau, O. A. Vydrov, A. F. Izmaylov, and G. E.
ScuseriaJ. Chem. Phys. 125, 224106 (2006)</p>
</div>
</div>
<div class="section" id="scissors-correction-at-donor-acceptor-interface">
<h2>5.8 scissors correction at donor/acceptor interface<a class="headerlink" href="#scissors-correction-at-donor-acceptor-interface" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id12">
<h3>5.8.1 (On/Off)<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p><strong>lscissors</strong> = [boolean]</p>
<p>Default: <strong>lscissors</strong> = .FALSE.</p>
<p>.TRUE. : Take into account .FASLE. : Do not</p>
</div>
<div class="section" id="id13">
<h3>5.8.2 (unit of energy)<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>(ry) or (hr) or (ev)</p>
</div>
<div class="section" id="corrections">
<h3>5.8.3 (corrections)<a class="headerlink" href="#corrections" title="Permalink to this headline">¶</a></h3>
<p><strong>ecorr_acceptor</strong> = [real] <strong>ecorr_donor</strong> = [real]</p>
<p>Default <strong>ecorr_acceptor</strong> = 0.0 <strong>ecorr_donor</strong> = 0.0</p>
<p>Corrections to be subtracted from the eigenenergies.</p>
</div>
<div class="section" id="unit-of-length">
<h3>5.8.4 (unit of length)<a class="headerlink" href="#unit-of-length" title="Permalink to this headline">¶</a></h3>
<p>(bohr) or (ang)</p>
</div>
<div class="section" id="boundary">
<h3>5.8.5 (boundary)<a class="headerlink" href="#boundary" title="Permalink to this headline">¶</a></h3>
<p><strong>zboundary</strong> = [real]</p>
<p>Default: <strong>zboundary</strong> = 0.0 Defines the boundary between acceptor and
donor regions as follows: z-coordinate &lt; <strong>zboundary</strong>: acceptor region
z-coordinate &gt; <strong>zboundary</strong>: donor region</p>
</div>
</div>
<div class="section" id="id14">
<h2>5.9 k-points<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<div class="section" id="number-of-k-points">
<h3>5.9.1 (number of k points)<a class="headerlink" href="#number-of-k-points" title="Permalink to this headline">¶</a></h3>
<p><strong>nkpnt</strong> = [integer]</p>
<p>Default: (gamma point) <strong>nkpnt</strong> = 1</p>
<p><strong>nkpnt</strong> is the number of k points. If <strong>nkpnt</strong> is greater than zero,
you set k vectors in (k vectors). If <strong>nkpnt</strong> is zero, you set the
number of division for the reciprocal vectors in (division number).</p>
</div>
<div class="section" id="k-vectors">
<h3>5.9.2 (k vectors)<a class="headerlink" href="#k-vectors" title="Permalink to this headline">¶</a></h3>
<p><strong>(bzk,wbzk)</strong> = [real] [real] [real] [real]</p>
<p>Default: (gamma point) <strong>bzk(1:3)</strong> = (/0.0 0.0 0.0/) <strong>wbzk</strong> = 1.0</p>
<p><strong>bzk(1:3)</strong> are k vectors and <strong>wbzk</strong> is the weight of each k-vector.
Note that this subsection is only considered when <strong>nkpnt</strong> is greater
than zero.Also, Please set K vectors between -0.5 and 0.5.</p>
</div>
<div class="section" id="division-number">
<h3>5.9.3 (division number)<a class="headerlink" href="#division-number" title="Permalink to this headline">¶</a></h3>
<p><strong>npkx(1:3)</strong> = [integer] [integer] [integer]</p>
<p>Default: <strong>npkx(1:3)</strong> = (/ 1 1 1 /)</p>
<p><strong>npkx(1:3)</strong> is the number of division for reciprocal vectors and
Monkhorst-Pack method is used. <a class="reference external" href="#Monkhorst_1976">[1]</a></p>
</div>
<div class="section" id="tetrahedron-method">
<h3>5.9.4 (tetrahedron method)<a class="headerlink" href="#tetrahedron-method" title="Permalink to this headline">¶</a></h3>
<p><strong>ltetra</strong> = [boolean]</p>
<p>Default: <strong>ltetra</strong> = .FALSE.</p>
<p>.TRUE. : Use the tetrahedron method .FALSE. : Do not use</p>
<p>Determines whether to use the modified tetrahedron method
<a class="reference external" href="#Blochl_1994">[2]</a> for the Brillouin Zone integration.</p>
</div>
<div class="section" id="id15">
<h3>Reference:<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>1. “Special points for Brillouin-zone integrations” H. J. Monkhorst and
J. D. Pack, O. Jepsen, and O. K. Andersen. Phys. Rev. B 13, 5188 (1976)
2. “Improved tetrahedron method for Brillouin-zone integrations.” P. E.
Blöchl, O. Jepsen, and O. K. Andersen. Phys. Rev. B 49, 16223 (1994)</p>
</div>
</div>
<div class="section" id="electric-field">
<h2>5.10 electric field<a class="headerlink" href="#electric-field" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id16">
<h3>5.10.1 (On/Off)<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p><strong>lefield</strong> = [boolean]</p>
<p>Default: <strong>lefield</strong> = .FALSE.</p>
<p>.TRUE. : Apply uniform electric field. .FALSE. : No electric field.</p>
</div>
<div class="section" id="id17">
<h3>5.10.2 (electric field)<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p><strong>efield(1:3)</strong> = [real] [real] [real]</p>
<p>Determines the uniform electric field in atomic units.
<a class="reference external" href="#Umari_2001">[1]</a></p>
</div>
<div class="section" id="id18">
<h3>Reference:<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>19. “Ab initio molecular dynamics in a finite homogeneous electric
field.” P. Umari, and A. Pasquarello. Phys. Rev. Lett. 89,157602 (2002)</p>
</div>
</div>
<div class="section" id="spin-polarization">
<h2>5.11 spin polarization<a class="headerlink" href="#spin-polarization" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id19">
<h3>5.11.1 (On/Off)<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<p><strong>lspin</strong> = [boolean]</p>
<p>Default: <strong>lspin</strong> = .FALSE.</p>
<p>.TRUE. : Apply spin polarization .FALSE. : Do not use</p>
<p>Determines whether to take into account spin polarization.</p>
</div>
<div class="section" id="noncollinear-magnetism">
<h3>5.11.2 (noncollinear magnetism)<a class="headerlink" href="#noncollinear-magnetism" title="Permalink to this headline">¶</a></h3>
<p><strong>lnoncollinear</strong> = [boolean]</p>
<p>Default: <strong>lnoncollinear</strong> = .FALSE.</p>
<p>.TRUE. : Noncollinear magnetism .FALSE. : Collinear magnetism</p>
<p>Note that the DFT calculation by noncollinear magnetism is still under
development (SCF iterations might not converge).</p>
</div>
<div class="section" id="fix-spin-polarization">
<h3>5.11.3 (fix spin polarization)<a class="headerlink" href="#fix-spin-polarization" title="Permalink to this headline">¶</a></h3>
<p><strong>lfixud</strong> = [boolean]</p>
<p>Default: <strong>lfixud</strong> = .TRUE.</p>
<p>.TRUE. : Fix the value of spin polarization .FALSE. : Do not fix</p>
<p><strong>lfixud</strong> set to .TRUE. will be fixed the value of spin polarization.
Note that this subsection is only considered when <strong>lnoncollinear</strong> is
.FALSE.</p>
</div>
<div class="section" id="id20">
<h3>5.11.4 (spin polarization)<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<p><strong>diffud</strong> = [real]</p>
<p>Default: <strong>diffud</strong> = 0.0</p>
<p><strong>diffud</strong> is the value of spin polarization to fix total magnetic
moment. Note that this subsection is only considered when <strong>lfixud</strong> is
.TRUE.</p>
</div>
<div class="section" id="initial-wave-functions">
<h3>5.11.5 (initial wave functions)<a class="headerlink" href="#initial-wave-functions" title="Permalink to this headline">¶</a></h3>
<p><strong>lwfrand</strong> = [boolean]</p>
<p>Default: <strong>lfixud</strong> = .FALSE.</p>
<p>.FALSE. : Down spin is given as same as up spin .TRUE. : Down spin is
given by random number</p>
<p>Determines how to give the down spin.</p>
</div>
<div class="section" id="initial-spin-density">
<h3>5.11.6 (initial spin density)<a class="headerlink" href="#initial-spin-density" title="Permalink to this headline">¶</a></h3>
<p><strong>inispin</strong> = [0|1|2|3|4]</p>
<p>Default: <strong>inispin</strong> = 1</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>inispin</strong></th>
<th class="head">Initial spin density</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>0</strong></td>
<td>from LSDA (lnoncollinear = .TRUE.)</td>
</tr>
<tr class="row-odd"><td><strong>1</strong></td>
<td>uniformly polarized</td>
</tr>
<tr class="row-even"><td><strong>2</strong></td>
<td>ferromagnetic alignment</td>
</tr>
<tr class="row-odd"><td><strong>3</strong></td>
<td>antiferromagnetic random alignment</td>
</tr>
<tr class="row-even"><td><strong>4</strong></td>
<td>specify spin polarization par atom</td>
</tr>
</tbody>
</table>
<p><strong>inispin</strong> is used to specify the method for initial spin density. The
detail parameter is set in another subsection.</p>
</div>
<div class="section" id="uniform-spin-density-inispin-1-lnoncollinear-true">
<h3>5.11.7 (uniform spin density) —— <strong>inispin</strong> = 1 &amp; <strong>lnoncollinear</strong> = .TRUE.<a class="headerlink" href="#uniform-spin-density-inispin-1-lnoncollinear-true" title="Permalink to this headline">¶</a></h3>
<p><strong>atmmagne</strong> = [real] <strong>umx</strong>, <strong>umy</strong>, <strong>umz</strong> = [real] [real] [real]</p>
<p>If <strong>inispin</strong> is one, spin polarized uniformly. <strong>atmmagne</strong> is total
magnetic moment and (<strong>umx</strong>, <strong>umy</strong>, <strong>umz</strong>) are a magnetization
direction.</p>
</div>
<div class="section" id="ferromagnetic-spin-density-inispin-2">
<h3>5.11.8 (ferromagnetic spin density) —— <strong>inispin</strong> = 2<a class="headerlink" href="#ferromagnetic-spin-density-inispin-2" title="Permalink to this headline">¶</a></h3>
<p><strong>nspinat</strong> = [integer] <strong>iatspin</strong> = [integer] <strong>atmmagne</strong> = [real]
(<strong>umx</strong>, <strong>umy</strong>, <strong>umz</strong>) = [real] [real] [real]</p>
<p>Default: <strong>nspinat</strong> = 1</p>
<p>All <strong>itspin</strong>-type atoms are polarized with the magnetic moment of
<strong>atmmagne</strong>. (<strong>umx</strong>, <strong>umy</strong>, <strong>umz</strong>) are available only when
<strong>lnoncollinear</strong> is .TRUE. <strong>nspinat</strong> is the number of atom types to
be polarized.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ferromagnetic</span> <span class="n">spin</span> <span class="n">density</span><span class="p">)</span>
   <span class="mi">2</span>                          <span class="p">:</span> <span class="p">(</span><span class="n">nspinat</span><span class="p">)</span>
   <span class="mi">1</span>    <span class="mf">2.</span><span class="n">d0</span>  <span class="mf">0.</span><span class="n">d0</span> <span class="mf">0.</span><span class="n">d0</span> <span class="mf">1.</span><span class="n">d0</span>  <span class="p">:</span> <span class="p">(</span><span class="n">iatspin</span><span class="p">,</span> <span class="n">atmmagne</span><span class="p">,</span> <span class="n">umx</span><span class="p">,</span> <span class="n">umy</span><span class="p">,</span> <span class="n">umz</span><span class="p">)</span>
   <span class="mi">2</span>   <span class="o">-</span><span class="mf">4.</span><span class="n">d0</span>  <span class="mf">0.</span><span class="n">d0</span> <span class="mf">0.</span><span class="n">d0</span> <span class="mf">1.</span><span class="n">d0</span>  <span class="p">:</span> <span class="p">(</span><span class="n">iatspin</span><span class="p">,</span> <span class="n">atmmagne</span><span class="p">,</span> <span class="n">umx</span><span class="p">,</span> <span class="n">umy</span><span class="p">,</span> <span class="n">umz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="antiferromagnetic-spin-density-inispin-3">
<h3>5.11.9 (antiferromagnetic spin density) —— <strong>inispin</strong> = 3<a class="headerlink" href="#antiferromagnetic-spin-density-inispin-3" title="Permalink to this headline">¶</a></h3>
<p><strong>nspinat</strong> = [integer] <strong>iatspin</strong> = [integer] <strong>atmmagne</strong> = [real]
(<strong>umx</strong>, <strong>umy</strong>, <strong>umz</strong>) = [real] [real] [real]</p>
<p>Default: <strong>nspinat</strong> = 1</p>
<p>Half of <strong>itspin</strong>-type atoms are polarized with the magnetic moment of
<strong>atmmagne</strong>, and the rest are polarized with the magnetic moment of
<strong>-atmmagne</strong>. (<strong>umx</strong>, <strong>umy</strong>, <strong>umz</strong>) are available only when
<strong>lnoncollinear</strong> is .TRUE. <strong>nspinat</strong> is the number of atom types to
be polarized.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">antiferromagnetic</span> <span class="n">spin</span> <span class="n">density</span><span class="p">)</span>
   <span class="mi">2</span>                          <span class="p">:</span> <span class="p">(</span><span class="n">nspinat</span><span class="p">)</span>
   <span class="mi">1</span>    <span class="mf">2.</span><span class="n">d0</span>  <span class="mf">0.</span><span class="n">d0</span> <span class="mf">0.</span><span class="n">d0</span> <span class="mf">1.</span><span class="n">d0</span>  <span class="p">:</span> <span class="p">(</span><span class="n">iatspin</span><span class="p">,</span> <span class="n">atmmagne</span><span class="p">,</span> <span class="n">umx</span><span class="p">,</span> <span class="n">umy</span><span class="p">,</span> <span class="n">umz</span><span class="p">)</span>
   <span class="mi">2</span>   <span class="o">-</span><span class="mf">4.</span><span class="n">d0</span>  <span class="mf">0.</span><span class="n">d0</span> <span class="mf">0.</span><span class="n">d0</span> <span class="mf">1.</span><span class="n">d0</span>  <span class="p">:</span> <span class="p">(</span><span class="n">iatspin</span><span class="p">,</span> <span class="n">atmmagne</span><span class="p">,</span> <span class="n">umx</span><span class="p">,</span> <span class="n">umy</span><span class="p">,</span> <span class="n">umz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="atomic-spin-density-inispin-4">
<h3>5.11.10 (atomic spin density) —— <strong>inispin</strong> = 4<a class="headerlink" href="#atomic-spin-density-inispin-4" title="Permalink to this headline">¶</a></h3>
<p><strong>nspinat</strong> = [integer] <strong>iatspin</strong> = [integer] <strong>atmmagne</strong> = [real]
(<strong>umx</strong>, <strong>umy</strong>, <strong>umz</strong>) = [real] [real] [real]</p>
<p>Default: <strong>nspinat</strong> = 1</p>
<p>You can specify the magnetic moment of <strong>atmmagne</strong> par atom.
<strong>iatspin</strong> is the index of atom number. (<strong>umx</strong>, <strong>umy</strong>, <strong>umz</strong>) are
available only when <strong>lnoncollinear</strong> is .TRUE. <strong>nspinat</strong> is the
number of atom types to be polarized.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">atomic</span> <span class="n">spin</span> <span class="n">density</span><span class="p">)</span>
   <span class="mi">4</span>                          <span class="p">:</span> <span class="p">(</span><span class="n">nspinat</span><span class="p">)</span>
  <span class="mi">10</span>    <span class="mf">2.</span><span class="n">d0</span>  <span class="mf">0.</span><span class="n">d0</span> <span class="mf">0.</span><span class="n">d0</span> <span class="mf">1.</span><span class="n">d0</span>  <span class="p">:</span> <span class="p">(</span><span class="n">iatspin</span><span class="p">,</span> <span class="n">atmmagne</span><span class="p">,</span> <span class="n">umx</span><span class="p">,</span> <span class="n">umy</span><span class="p">,</span> <span class="n">umz</span><span class="p">)</span>
  <span class="mi">11</span>    <span class="mf">2.</span><span class="n">d0</span>  <span class="mf">0.</span><span class="n">d0</span> <span class="mf">0.</span><span class="n">d0</span> <span class="mf">1.</span><span class="n">d0</span>  <span class="p">:</span> <span class="p">(</span><span class="n">iatspin</span><span class="p">,</span> <span class="n">atmmagne</span><span class="p">,</span> <span class="n">umx</span><span class="p">,</span> <span class="n">umy</span><span class="p">,</span> <span class="n">umz</span><span class="p">)</span>
  <span class="mi">23</span>    <span class="mf">2.</span><span class="n">d0</span>  <span class="mf">0.</span><span class="n">d0</span> <span class="mf">0.</span><span class="n">d0</span> <span class="mf">1.</span><span class="n">d0</span>  <span class="p">:</span> <span class="p">(</span><span class="n">iatspin</span><span class="p">,</span> <span class="n">atmmagne</span><span class="p">,</span> <span class="n">umx</span><span class="p">,</span> <span class="n">umy</span><span class="p">,</span> <span class="n">umz</span><span class="p">)</span>
  <span class="mi">24</span>    <span class="mf">2.</span><span class="n">d0</span>  <span class="mf">0.</span><span class="n">d0</span> <span class="mf">0.</span><span class="n">d0</span> <span class="mf">1.</span><span class="n">d0</span>  <span class="p">:</span> <span class="p">(</span><span class="n">iatspin</span><span class="p">,</span> <span class="n">atmmagne</span><span class="p">,</span> <span class="n">umx</span><span class="p">,</span> <span class="n">umy</span><span class="p">,</span> <span class="n">umz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="reference-direction-lnoncollinear-true">
<h3>5.11.11 (reference direction) —— <strong>lnoncollinear</strong> = .TRUE.<a class="headerlink" href="#reference-direction-lnoncollinear-true" title="Permalink to this headline">¶</a></h3>
<p><strong>refmx</strong>, <strong>refmy</strong>, <strong>refmz</strong> = [real] [real] [real]</p>
<p>Default: <strong>refmx</strong>, <strong>refmy</strong>, <strong>refmz</strong> = (/ 0.0 0.0 1.0/)</p>
<p>When <strong>lnoncollinear</strong> is .TRUE., <strong>refmx</strong>, <strong>refmy</strong>, <strong>refmz</strong> shows
the reference direction.</p>
</div>
<div class="section" id="duplicate-the-up-spin-state-lnoncollinear-false">
<h3>5.11.12 (duplicate the up-spin state) —— <strong>lnoncollinear</strong> = .FALSE.<a class="headerlink" href="#duplicate-the-up-spin-state-lnoncollinear-false" title="Permalink to this headline">¶</a></h3>
<p><strong>lduplicate</strong> = [boolean]</p>
<p>Default: <strong>lduplicate</strong> = .FALSE.</p>
<p>.TRUE. : Duplicate wavefunction of the up spin state .FALSE. : Do not
duplicate</p>
</div>
</div>
<div class="section" id="scf-iterations">
<h2>5.12 SCF iterations<a class="headerlink" href="#scf-iterations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="global-iterations">
<h3>5.12.1 (global iterations)<a class="headerlink" href="#global-iterations" title="Permalink to this headline">¶</a></h3>
<p><strong>iscfmx</strong> = [integer]</p>
<p>Default: <strong>iscfmx</strong> = 100</p>
<p>Gives the maximum number of global iterations of SCF to be performed.</p>
</div>
<div class="section" id="trial-global-iterations">
<h3>5.12.2 (trial global iterations)<a class="headerlink" href="#trial-global-iterations" title="Permalink to this headline">¶</a></h3>
<p><strong>itrial</strong> = [integer]</p>
<p>Default: <strong>itrial</strong> = 0</p>
<p>Gives the number of trial global iterations</p>
</div>
<div class="section" id="trial-charge-mixing">
<h3>5.12.3 (trial charge mixing)<a class="headerlink" href="#trial-charge-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>imxchg_trial</strong> = [0|1] <strong>aslh_trial, bslh_trial</strong> = [real] [real]</p>
<p>Default: <strong>imxchg_trial</strong> = 0 <strong>aslh_trial</strong> = 0.1 <strong>bslh_trial</strong> = 0.64</p>
<p><strong>imxchg_trial</strong> = 0 : No trial charge mixing <strong>imxchg_trial</strong> = 1 :
Trial charge mixing</p>
<p>Determines whether to perform trial charge mixing, and if so, the tuning
parameters, <strong>aslh_trial, bslh_trial</strong>, to be used.</p>
</div>
<div class="section" id="trial-spin-density-mixing">
<h3>5.12.4 (trial spin-density mixing)<a class="headerlink" href="#trial-spin-density-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>imxspin_trial</strong> = [0|1] <strong>amxspin_trial, bmxspin_trial</strong> = [real]
[real]</p>
<p>Default: <strong>imxspin_trial</strong> = 0 <strong>amxspin_trial</strong> = 0.1 <strong>bmxspin_trial</strong>
= 0.64</p>
</div>
<div class="section" id="tolerances">
<h3>5.12.5 (tolerances)<a class="headerlink" href="#tolerances" title="Permalink to this headline">¶</a></h3>
<p><strong>tolpot</strong> = [real] <strong>tolres</strong> = [real]</p>
<p>Default: <strong>tolpot</strong> = 5.0d-09 <strong>tolres</strong> = 5.0d-09</p>
<p><strong>tolpot</strong> gives the tolerance for change in total energy. Once the
change in total energy between subsequent SCF iterations is smaller than
the tolerance, the SCF iterations are considered to have converged.
<strong>tolres</strong> similarly gives the tolerance for average residual.</p>
</div>
<div class="section" id="hc-products">
<h3>5.12.6 (HC products)<a class="headerlink" href="#hc-products" title="Permalink to this headline">¶</a></h3>
<p><strong>lhcunt</strong> = [boolean]</p>
<p>Default: <strong>lhcunt</strong> = .TRUE.</p>
<p>.TRUE. : HC products by Unitary tr. .FALSE. : ???</p>
<p>???</p>
</div>
<div class="section" id="charge-mixing">
<h3>5.12.7 (charge mixing)<a class="headerlink" href="#charge-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>imxchg</strong> = [0|1|2|3|4|5|6] <strong>aslh, bslh</strong> = [real] [real]</p>
<p>Default: <strong>imxchg</strong> = 1</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">imxchg</th>
<th class="head">Charge Mixing Method</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>0</strong></td>
<td>No Mixing</td>
</tr>
<tr class="row-odd"><td><strong>1</strong></td>
<td>Pulay</td>
</tr>
<tr class="row-even"><td><strong>2</strong></td>
<td>Anderson</td>
</tr>
<tr class="row-odd"><td><strong>3</strong></td>
<td>Simple</td>
</tr>
<tr class="row-even"><td><strong>4</strong></td>
<td>Srivastava</td>
</tr>
<tr class="row-odd"><td><strong>5</strong></td>
<td>Johnson</td>
</tr>
<tr class="row-even"><td><strong>6</strong></td>
<td>Johnson w/ variable weights</td>
</tr>
</tbody>
</table>
<p>Determines which charge mixing method will be used, along with tuning
parameters for that method.</p>
</div>
<div class="section" id="number-of-mixing">
<h3>5.12.8 (number of mixing)<a class="headerlink" href="#number-of-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>itratn</strong> = [integer]</p>
<p>Default: <strong>itratn</strong> = 10</p>
<p>Determines how many charge densities from previous SCF iterations to use
for charge mixing. Not available for imxchg = [0|3].</p>
</div>
<div class="section" id="metric-in-charge-mixing">
<h3>5.12.9 (metric in charge mixing)<a class="headerlink" href="#metric-in-charge-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>cmetric</strong> = [real]</p>
<p>Default: <strong>cmetric</strong> = 20.0</p>
<p>Gives the metric for charge mixing. Used as the weighting factor w(g) in
the calculation of residual is given by:</p>
<p>w(g) = (cmetric-1)*G_min^2*G_max^2/(G_max^2 - cmetric*G_min^2)</p>
<p>Not available for imxchg = [0|3].</p>
</div>
<div class="section" id="magnetic-moment-mixing">
<h3>5.12.10 (magnetic moment mixing)<a class="headerlink" href="#magnetic-moment-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>lmixreal</strong> = [boolean]</p>
<p>Default: <strong>lmixreal</strong> = .TRUE.</p>
<p>.TRUE. :real-space mixing .FALSE. : reciprocal-spcace mixing</p>
<p>This is only read when <strong>lnoncollinear</strong> in the (noncollinear magnetism)
subsection of the spin polarization section is set to .TRUE.</p>
</div>
<div class="section" id="spin-density-mixing">
<h3>5.12.11 (spin-density mixing)<a class="headerlink" href="#spin-density-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>imxspin</strong> = [0|1|2|3|4|5|6] <strong>amxspin, bmxspin</strong> = [real] [real]</p>
<p>Default: <strong>imxspin</strong> = 0 <strong>amxspin</strong> = 0.8 <strong>bmxspin</strong> = 0.64</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">imxspin</th>
<th class="head">Charge Mixing Method</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>0</strong></td>
<td>No Mixing</td>
</tr>
<tr class="row-odd"><td><strong>1</strong></td>
<td>Pulay</td>
</tr>
<tr class="row-even"><td><strong>2</strong></td>
<td>Anderson</td>
</tr>
<tr class="row-odd"><td><strong>3</strong></td>
<td>Simple</td>
</tr>
<tr class="row-even"><td><strong>4</strong></td>
<td>Srivastava</td>
</tr>
<tr class="row-odd"><td><strong>5</strong></td>
<td>Johnson</td>
</tr>
<tr class="row-even"><td><strong>6</strong></td>
<td>Johnson w/ variable weights</td>
</tr>
</tbody>
</table>
<p>This is only calculated when spin polarization is enabled in the *spin
polarization section.</p>
</div>
<div class="section" id="of-spin-density-mixing">
<h3>5.12.12 (# of spin-density mixing)<a class="headerlink" href="#of-spin-density-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>nmxspin</strong> = [integer]</p>
<p>Default: <strong>nmxspin</strong> = 10</p>
<p>Determines how many spin densities from previous SCF iterations to use
for spin density mixing.</p>
</div>
<div class="section" id="spin-metric-in-spin-density-mixing">
<h3>5.12.13 (spin metric in spin-density mixing)<a class="headerlink" href="#spin-metric-in-spin-density-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>spinmetric</strong> = [real]</p>
<p>Default: <strong>spinmetric</strong> = 1.0</p>
<p>The metric in spin-density mixing. This variable is only read when
<strong>lnoncollinear</strong> == .FALSE. or <strong>lmixreal</strong> == .FALSE.</p>
</div>
<div class="section" id="kerker-mixing-weight-in-spin-density-mixing">
<h3>5.12.14 (Kerker-mixing weight in spin-density mixing)<a class="headerlink" href="#kerker-mixing-weight-in-spin-density-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>wkerker</strong> = [real]</p>
<p>Default: <strong>wkerker</strong> = 1.0</p>
<p>Kerker-mixing weight in spin-density mixing. This variable is only read
when <strong>lnoncollinear</strong> == .FALSE. or <strong>lmixreal</strong> == .FALSE.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Sigma_new(G) = sigma_in(G) + K(G)<code class="docutils literal notranslate"><span class="pre">*(sigma_out(G)</span> <span class="pre">-sigma_in(G)),</span> <span class="pre">where</span> <span class="pre">sigma</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">spin</span> <span class="pre">density,</span> <span class="pre">and</span> <span class="pre">K(G)</span> <span class="pre">=</span> <span class="pre">amxspin*\</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">wkerker</span> <span class="pre">+</span> <span class="pre">wkerker*G~2/(G^2</span> <span class="pre">+</span> <span class="pre">bmxspin)).</span> <span class="pre">Note</span> <span class="pre">that</span> <span class="pre">sigma(G=0)</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">updated</span> <span class="pre">when</span> <span class="pre">wkerker</span> <span class="pre">=</span> <span class="pre">1.d0,</span> <span class="pre">i.e.,</span> <span class="pre">the</span> <span class="pre">difference</span> <span class="pre">between</span> <span class="pre">the</span> <span class="pre">numbers</span> <span class="pre">of</span> <span class="pre">up-</span> <span class="pre">and</span> <span class="pre">down-spin</span> <span class="pre">is</span> <span class="pre">fixed.</span></code></p>
</div>
<p>Not available for imxchg = [0|3].</p>
</div>
<div class="section" id="output-eigenvalues">
<h3>5.12.15 (output eigenvalues)<a class="headerlink" href="#output-eigenvalues" title="Permalink to this headline">¶</a></h3>
<p><strong>louteig</strong> = [boolean]</p>
<p>Default: <strong>louteig</strong> = .FALSE.</p>
<p>.TRUE. : Output eigenvalues to file .FALSE. : Do not output eigenvalues</p>
<p>Whether or not to output eigenvalues through SCF iterations.</p>
</div>
<div class="section" id="output-energy-parts">
<h3>5.12.16 (output energy parts)<a class="headerlink" href="#output-energy-parts" title="Permalink to this headline">¶</a></h3>
<p><strong>loutenergy</strong> = [boolean]</p>
<p>Default: <strong>loutenergy</strong> = .FALSE.</p>
<p>.TRUE. : Output energy parts to file .FALSE. : Do not output energy
parts</p>
<p>Whether or not to output energy parts through SCF iterations</p>
</div>
<div class="section" id="output-residuals">
<h3>5.12.17 (output residuals)<a class="headerlink" href="#output-residuals" title="Permalink to this headline">¶</a></h3>
<p><strong>loutzansa</strong> = [boolean]</p>
<p>Default: <strong>loutzansa</strong> = .FALSE.</p>
<p>.TRUE. : Output residuals (standard deviation) to file .FALSE. : Do not
output residuals.</p>
<p>Whether or not to output residuals through SCF iterations</p>
</div>
<div class="section" id="convergence-stabilizer">
<h3>5.12.18 (convergence stabilizer)<a class="headerlink" href="#convergence-stabilizer" title="Permalink to this headline">¶</a></h3>
<p><strong>nstabi</strong> = [integer] <strong>xstabi</strong> = [real]</p>
<p>Default: <strong>nstabi</strong> = 10 <strong>xstabi</strong> = 10.0</p>
<p>If zansa2 &lt; zansa2/xstabi at nstabi iterations before, set lreset =
.FALSE.</p>
</div>
</div>
<div class="section" id="well-potenial">
<h2>5.13 well potenial<a class="headerlink" href="#well-potenial" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id21">
<h3>5.13.1 (On/Off)<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p><strong>lwell</strong> = [boolean]</p>
<p>Default: <strong>lwell</strong> = .FALSE.</p>
<p>Determines whether to use a well potential outide atomic sphere.</p>
</div>
<div class="section" id="height-of-potential">
<h3>5.13.2 (height of potential)<a class="headerlink" href="#height-of-potential" title="Permalink to this headline">¶</a></h3>
<p><strong>wellheight</strong> = [real]</p>
<p>Default: <strong>wellheight</strong> = 1.0</p>
<p>Gives the height of the well potenital in Rydbergs.</p>
</div>
<div class="section" id="radius-around-each-atom">
<h3>5.13.3 (radius around each atom)<a class="headerlink" href="#radius-around-each-atom" title="Permalink to this headline">¶</a></h3>
<p><strong>nwellat</strong> = [integer] <strong>iatwell, radwell</strong> = [integer] [real]</p>
<p>Default: <strong>nwellat</strong> = 0</p>
<p><strong>nwellat</strong> gives the total number of atom types for which to make a
well potential around, followed by that many lines of <strong>iatwell</strong>,
giving the atom type index and <strong>radwell</strong>, giving the radius around
each atom in bohrs. If not specified (atom type 2 in this case), the
covalent radius is used.</p>
<p>Example: This defines the radius around atom types 1,3, a total of 2
atom types, to be 1.9 bohrs. Atom type 2, for which no radius is given,
will have its covalent radius used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">radius</span> <span class="n">around</span> <span class="n">each</span> <span class="n">atom</span><span class="p">)</span>
   <span class="mi">2</span>
   <span class="mi">1</span>    <span class="mf">1.9</span><span class="n">d0</span>
   <span class="mi">3</span>    <span class="mf">1.9</span><span class="n">d0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="kohn-sham-equation">
<h2>5.14 Kohn-Sham equation<a class="headerlink" href="#kohn-sham-equation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id22">
<h3>5.14.1 (On/Off)<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p><strong>ihldam</strong> = [1|2]</p>
<p>Default: <strong>ihldam</strong> = 1</p>
<p>1 : Conjugate-Gradient (CG) Method 2 : Residual minimization scheme,
direct inversion in the iterative subspace (RMM-DIIS) Method</p>
<p>Determines the method used in the iterative minimization of energy as a
functional of wavefunctions.</p>
</div>
<div class="section" id="tolerance">
<h3>5.14.2 (tolerance)<a class="headerlink" href="#tolerance" title="Permalink to this headline">¶</a></h3>
<p><strong>toleig</strong> = [real]</p>
<p>Default: <strong>toleig</strong> = 1.d-10</p>
<p>Gives the tolerance for the Kohn-Sham equations.</p>
</div>
<div class="section" id="threshold-for-w-f-direction">
<h3>5.14.3 (threshold for w.f. direction)<a class="headerlink" href="#threshold-for-w-f-direction" title="Permalink to this headline">¶</a></h3>
<p><strong>threinn</strong> = [real]</p>
<p>Default: <strong>threinn</strong> = 0.0</p>
<p>Gives the threshold for direction of new wavefunction</p>
</div>
<div class="section" id="iteration">
<h3>5.14.4 (iteration)<a class="headerlink" href="#iteration" title="Permalink to this headline">¶</a></h3>
<p><strong>itermx</strong> = [integer]</p>
<p>Default: <strong>itermx</strong> = 4</p>
<p>Gives the maximum number of iterations.</p>
</div>
<div class="section" id="empty-band-iteration">
<h3>5.14.5 (empty-band iteration)<a class="headerlink" href="#empty-band-iteration" title="Permalink to this headline">¶</a></h3>
<p><strong>iteremx</strong> = [integer]</p>
<p>Default: <strong>iteremx</strong> = 4</p>
<p>Gives the maximum number of iterations for empty bands.</p>
</div>
<div class="section" id="id23">
<h3>5.14.6 (trial global iterations)<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<p><strong>kstrial</strong> = [integer]</p>
<p>Default: <strong>kstrial</strong> = 0</p>
<p>Gives the number of trial global iterations with itermx = iteremx = 1</p>
</div>
<div class="section" id="cg-method">
<h3>5.14.7 (CG method)<a class="headerlink" href="#cg-method" title="Permalink to this headline">¶</a></h3>
<p><strong>methodcg</strong> = [1|2]</p>
<p>Default: <strong>methodcg</strong> = 2</p>
<p>1:line minimization 2:BKL [ref]</p>
<p>Gives the method used of CG This variable is only read if <strong>ihldam</strong> ==
1</p>
</div>
</div>
<div class="section" id="poisson-equation">
<h2>5.15 Poisson equation<a class="headerlink" href="#poisson-equation" title="Permalink to this headline">¶</a></h2>
<p>Note this section is only used for cluster calculations.</p>
<div class="section" id="multigrid-level">
<h3>5.15.1 (multigrid level)<a class="headerlink" href="#multigrid-level" title="Permalink to this headline">¶</a></h3>
<p><strong>multg</strong> = [integer]</p>
<p>Default: <strong>multg</strong> = 2</p>
<p>??</p>
</div>
<div class="section" id="id24">
<h3>5.15.2 (tolerance)<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<p><strong>tolcg</strong> = [real]</p>
<p>Default: <strong>tolcg</strong> = 1.d-11</p>
<p>Gives the tolerance energy in a.u. for one electron</p>
</div>
<div class="section" id="preconditioner">
<h3>5.15.3 (preconditioner)<a class="headerlink" href="#preconditioner" title="Permalink to this headline">¶</a></h3>
<p><strong>weigrd</strong> = [real]</p>
<p>Default: <strong>weigrd</strong> = 0.4</p>
<p>???</p>
</div>
<div class="section" id="differentiation">
<h3>5.15.4 (differentiation)<a class="headerlink" href="#differentiation" title="Permalink to this headline">¶</a></h3>
<p><strong>nd2v</strong> = [integer]</p>
<p>Default: <strong>nd2v</strong> = 6</p>
<p>Gives the order of numerical differentiation.</p>
</div>
<div class="section" id="mesh-for-serial-calculation">
<h3>5.15.5 (mesh for serial calculation)<a class="headerlink" href="#mesh-for-serial-calculation" title="Permalink to this headline">¶</a></h3>
<p><strong>msrhmx, msrhmy, msrhmz</strong> = [integer] [integer] [integer]</p>
<p>Default: <strong>msrhmx, msrhmy, msrhmz</strong> = 14 14 14</p>
<p>Gives the mesh size for serial calculation.</p>
</div>
</div>
<div class="section" id="molecular-dynamics">
<h2>5.16 molecular dynamics<a class="headerlink" href="#molecular-dynamics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id25">
<h3>5.16.1 (On/Off)<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<p><strong>ifmd</strong> = [0|1|2|3|4|5|10]</p>
<p>Default: <strong>ifmd</strong> = 0</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ifmd</th>
<th class="head">Type of Dynamics</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>0</strong></td>
<td>Single Step</td>
</tr>
<tr class="row-odd"><td><strong>1</strong></td>
<td>Optimization</td>
</tr>
<tr class="row-even"><td><strong>2</strong></td>
<td>NVE</td>
</tr>
<tr class="row-odd"><td><strong>3</strong></td>
<td>NVT</td>
</tr>
<tr class="row-even"><td><strong>4</strong></td>
<td>NPT</td>
</tr>
<tr class="row-odd"><td><strong>5</strong></td>
<td>NVT for each atom</td>
</tr>
<tr class="row-even"><td><strong>10</strong></td>
<td>MSST [ref]</td>
</tr>
</tbody>
</table>
<p>Determines the type of QMD simulation to run. Add short description of
each type.</p>
</div>
<div class="section" id="id26">
<h3>5.16.2 (time step)<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<p><strong>dtmd, nstop</strong> = [real] [integer]</p>
<p>Default: <strong>dtmd</strong> = 50.0 <strong>nstop</strong> = 10</p>
<p><strong>dtmd</strong> gives the time step for QMD simulation in [a.u.], while
<strong>nstop</strong> gives the total number of time steps to simulate. Thus, the
total simulation time will equal (<strong>nstop</strong> * <strong>dtmd</strong>)</p>
</div>
<div class="section" id="initial-step-number">
<h3>5.16.3 (initial step number)<a class="headerlink" href="#initial-step-number" title="Permalink to this headline">¶</a></h3>
<p><strong>nstep_ini</strong> = [integer]</p>
<p>Default: <strong>nstep_ini</strong> = 0</p>
<p>Gives the initial step number. This varibale is ignored for <strong>lstart</strong>
== .TRUE.</p>
</div>
<div class="section" id="temperature">
<h3>5.16.4 (temperature)<a class="headerlink" href="#temperature" title="Permalink to this headline">¶</a></h3>
<p><strong>treq</strong> = [real]</p>
<p>Default: <strong>treq</strong> = 300.0</p>
<p>Gives the initial temperature in [K] for NVE, NVT, and NPT QMD
simulations.</p>
</div>
<div class="section" id="check-temperature">
<h3>5.16.5 (check temperature)<a class="headerlink" href="#check-temperature" title="Permalink to this headline">¶</a></h3>
<p><strong>liscale</strong> = [boolean] <strong>iscnum</strong> = [integer] <strong>iscstp</strong> = [integer]</p>
<p>Default: <strong>liscale</strong> = .FALSE. <strong>iscnum</strong> = 25 <strong>iscstp</strong> = 20</p>
<p><strong>liscale</strong> = .FALSE. : Do not scale temperature. <strong>liscale</strong> = .TRUE. :
Scale temperature a total of <strong>iscstp</strong> times, with <strong>iscnum</strong> steps in
between each scaling.</p>
<p>Determines whether and how to scale temperature to keep it near the
initial given temperature.</p>
</div>
<div class="section" id="make-total-momentum-zero">
<h3>5.16.6 (make total momentum zero)<a class="headerlink" href="#make-total-momentum-zero" title="Permalink to this headline">¶</a></h3>
<p><strong>lmomzero</strong> = [boolean]</p>
<p>Deafault: <strong>lmomzero</strong> = .FALSE.</p>
<p>.TRUE. : Make the total momentum zero. .FALSE. : Do not</p>
</div>
<div class="section" id="optimization">
<h3>5.16.7 (optimization)<a class="headerlink" href="#optimization" title="Permalink to this headline">¶</a></h3>
<p><strong>ioptmze</strong> = [-1|0|1|2|3|10]</p>
<p>Default: <strong>ioptmze</strong> = 2</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ioptmze</th>
<th class="head">Type of Structural Optimization</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>-1</strong></td>
<td>Do not optimize atomic coords</td>
</tr>
<tr class="row-odd"><td><strong>0</strong></td>
<td>Conjugate gradient</td>
</tr>
<tr class="row-even"><td><strong>1</strong></td>
<td>Projected velocity Verlet</td>
</tr>
<tr class="row-odd"><td><strong>2</strong></td>
<td>Quasi-Newton method with BFGS formula</td>
</tr>
<tr class="row-even"><td><strong>3</strong></td>
<td>RFO saddle points search</td>
</tr>
<tr class="row-odd"><td><strong>10</strong></td>
<td>Harmonic-mode analysis</td>
</tr>
</tbody>
</table>
<p>Determines method for structural optimization of atomic coordinates.
This varibale is onlt read when <strong>ifmd</strong> == 1.</p>
</div>
<div class="section" id="cell-optimization">
<h3>5.16.8 (cell optimization)<a class="headerlink" href="#cell-optimization" title="Permalink to this headline">¶</a></h3>
<p><strong>ioptmze_cell</strong> = [-1|0|1|2]</p>
<p>Default: <strong>ioptmze_cell</strong> = -1</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ioptmze_cell</th>
<th class="head">Type of Cell Optimization</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>-1</strong></td>
<td>Do not optimize supercell</td>
</tr>
<tr class="row-odd"><td><strong>0</strong></td>
<td>Conjugate gradient</td>
</tr>
<tr class="row-even"><td><strong>1</strong></td>
<td>Not yet implemented</td>
</tr>
<tr class="row-odd"><td><strong>2</strong></td>
<td>Quasi-Newton method with BFGS formula</td>
</tr>
</tbody>
</table>
<p>Determines method for optimization of (super)cell. This varibale is only
read when <strong>ifmd</strong> == 1, and is not not read when <strong>ioptmze</strong> == 1 or
10.</p>
</div>
<div class="section" id="cell-cg-time-step">
<h3>5.16.9 (cell CG time step)<a class="headerlink" href="#cell-cg-time-step" title="Permalink to this headline">¶</a></h3>
<p><strong>dtcellcg</strong> = [real]</p>
<p>Default: <strong>dtcellcg</strong> = 0.1</p>
<p>only for Conjugate gradient method (<strong>ifmd</strong> == 1 &amp; <strong>ioptmze_cell</strong> ==
0).</p>
</div>
<div class="section" id="stabilizer-for-quasi-newton">
<h3>5.16.10 (stabilizer for quasi-Newton)<a class="headerlink" href="#stabilizer-for-quasi-newton" title="Permalink to this headline">¶</a></h3>
<p><strong>gammamin</strong> = [real]</p>
<p>Default: <strong>gammamin</strong> = 0.1</p>
<p>only for quasi-Newton method (<strong>ifmd</strong> == 1 &amp; <strong>ioptmze</strong> == 2).</p>
</div>
<div class="section" id="clear-hessian">
<h3>5.16.11 (clear Hessian)<a class="headerlink" href="#clear-hessian" title="Permalink to this headline">¶</a></h3>
<p><strong>ibfgsclear</strong> = [0|1]</p>
<p>Default:</p>
<p><strong>ibfgsclear</strong> = 0</p>
<p>1: Clear Hessian after every ibfgsclear step 0: Hessian is not cleared</p>
</div>
<div class="section" id="clear-cell-hessian">
<h3>5.16.12 (clear cell Hessian)<a class="headerlink" href="#clear-cell-hessian" title="Permalink to this headline">¶</a></h3>
<p><strong>iclearcellh</strong> = [integer]</p>
<p>Default: <strong>iclearcellh</strong> = 0</p>
<p>Clear Hessian every <strong>iclearcellh</strong> step. If <strong>iclearcellh</strong> == 0, the
Hessian is not cleared.</p>
</div>
<div class="section" id="hybrid-optimization">
<h3>5.16.13 (hybrid optimization)<a class="headerlink" href="#hybrid-optimization" title="Permalink to this headline">¶</a></h3>
<p><strong>lhybridopt</strong> = [boolean] <strong>nstep_hybrid</strong> = [integer]
<strong>nstep_hybrid_cell</strong> = [integer]</p>
<p>Default: <strong>lhybridopt</strong> = .TRUE. <strong>nstep_hybrid</strong> = 10
<strong>nstep_hybrid_cell</strong> = 10</p>
<p><strong>lhybridopt</strong> = .TRUE. : Perform structural optimization first, then
cell optimization. <strong>lhybridopt</strong> = .FALSE. : Perform cell optimization
first, then structural optimization.</p>
<p><strong>nstep_hybrid</strong> is the time step for structural optimization.
<strong>nstep_hybrid_cell</strong> is the time step for cell optimization. These
variables are only read for optimization calculations(<strong>ifmd</strong> == 1 &amp;
<strong>ioptmze</strong> &gt;= 0 &amp; <strong>ioptmze_cell</strong> &gt;= 0 )</p>
</div>
<div class="section" id="displacement">
<h3>5.16.14 (displacement)<a class="headerlink" href="#displacement" title="Permalink to this headline">¶</a></h3>
<p><strong>hmadisp</strong> = [real]</p>
<p>Default: <strong>hmadisp</strong> = 0.01</p>
<p>Atomic displacement in [a.u.] for Harmonic analysis by finite
difference. This is only used for Harmonic-mode analysis (<strong>ifmd</strong> == 1
&amp; <strong>ioptmze</strong> == 10).</p>
</div>
<div class="section" id="order-of-differentiation">
<h3>5.16.15 (order of differentiation)<a class="headerlink" href="#order-of-differentiation" title="Permalink to this headline">¶</a></h3>
<p><strong>nhmaord</strong> = [integer]</p>
<p>Default: <strong>nhmaord</strong> = 1</p>
<p>Order of differentiation only defined for Harmonic-mode analysis
(<strong>ifmd</strong> == 1 &amp; <strong>ioptmze</strong> == 10).</p>
</div>
<div class="section" id="thermostat-parameters">
<h3>5.16.16 (thermostat parameters)<a class="headerlink" href="#thermostat-parameters" title="Permalink to this headline">¶</a></h3>
<p><strong>nnos</strong> = [integer] <strong>nresn</strong> = [integer] <strong>nyosh</strong> = [integer]
<strong>tomega</strong> = [real]</p>
<p>Default: <strong>nnos</strong> = 1 <strong>nresn</strong> = 1 <strong>nyosh</strong> = 1 <strong>tomega</strong> = 5500.0</p>
<p>[add references] Only for NVT &amp; NPT-MD (<strong>ifmd</strong> == 3, 4) Notes for
(tomega): The frequency for the thermostat will be given by omega [a.u.]
= 2*pi / tomega. The tomega will be determined from the period of VAF.
If you are not aware of it, try a value, 100 * dtmd in [a.u.], as an
initial guess.</p>
</div>
<div class="section" id="atom-type-with-thermostat">
<h3>5.16.17 (atom type with thermostat)<a class="headerlink" href="#atom-type-with-thermostat" title="Permalink to this headline">¶</a></h3>
<p><strong>nathermo</strong> = [integer] <strong>ithermo</strong> = [integer]</p>
<p>Only used for NVT for each atom (<strong>ifmd</strong> == 5)</p>
<p><strong>nathermo</strong> gives the total number of atom types to be given a
thermostat, followed by that many lines of <strong>ithermo</strong>, which specifies
the atom type.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>  <span class="p">:</span> <span class="p">(</span><span class="n">nathermo</span><span class="p">)</span> <span class="c1"># of atom types with thermostat</span>
<span class="mi">1</span>  <span class="p">:</span> <span class="p">(</span><span class="n">ithermo</span><span class="p">)</span> <span class="n">atom</span> <span class="nb">type</span>
<span class="mi">4</span>  <span class="p">:</span> <span class="p">(</span><span class="n">ithermo</span><span class="p">)</span> <span class="n">atom</span> <span class="nb">type</span>
</pre></div>
</div>
</div>
<div class="section" id="atom-thermostat-parameters">
<h3>5.16.18 (atom thermostat parameters)<a class="headerlink" href="#atom-thermostat-parameters" title="Permalink to this headline">¶</a></h3>
<p><strong>nnos_atom</strong> = [integer] <strong>nresn_atom</strong> = [integer] <strong>nyosh_atom</strong> =
[integer] <strong>tomega_atom</strong> = [real]</p>
<p>Default: <strong>nnos_atom</strong> = 1 <strong>nresn_atom</strong> = 1 <strong>nyosh_atom</strong> = 1
<strong>tomega_atom</strong> = 5500.0</p>
<p><strong>nnos_atom</strong> gives the number of thermostats, <strong>nresn_atom</strong> gives the
MTS steps for heat bath, <strong>nyosh_atom</strong> gives the Yoshida-Suzuki
decomposition step, and <strong>tomega_atom</strong> a period of fluctuation in
[a.u.]. This is only used for NVT for each atom (<strong>ifmd</strong> == 5).</p>
</div>
<div class="section" id="pressure">
<h3>5.16.19 (pressure)<a class="headerlink" href="#pressure" title="Permalink to this headline">¶</a></h3>
<p><strong>hpext</strong> = [real]</p>
<p>Default: <strong>hpext</strong> = 0.0</p>
<p>Defines the pressure in [GPa] for NPT-MD &amp; MSST (<strong>ifmd</strong> == 4, 10) &amp;
<strong>ioptmze_cell</strong> &gt;= 0.</p>
</div>
<div class="section" id="barostat-parameters">
<h3>5.16.20 (barostat parameters)<a class="headerlink" href="#barostat-parameters" title="Permalink to this headline">¶</a></h3>
<p><strong>tbomega</strong> = [real] <strong>blkmod</strong> = [real]</p>
<p>Default: <strong>tbomega</strong> = 5500.0 <strong>blkmod</strong> = 250.0</p>
<p>Barostat parameters for NPT (<strong>ifmd</strong> == 4). <strong>tbomega</strong> gives the time
scale for barostat in [a.u.], and <strong>blkmod</strong> gives the bulk modulus in
[GPa].</p>
</div>
<div class="section" id="restriction-for-md-cell">
<h3>5.16.21 (restriction for MD cell)<a class="headerlink" href="#restriction-for-md-cell" title="Permalink to this headline">¶</a></h3>
<p><strong>irstrct</strong> = [0|1|2|3|4|5|6|10|11|12|13|14|15|16]</p>
<p>Default: <strong>irstrct</strong> = 0</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">irstrct</th>
<th class="head">Type of Restriction on cell</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>0</strong></td>
<td>No restriction</td>
</tr>
<tr class="row-odd"><td><strong>1</strong></td>
<td><strong>Cubic</strong>: a=b=c; alpha=beta=gamma=90</td>
</tr>
<tr class="row-even"><td><strong>2</strong></td>
<td><strong>orthorhombic</strong>: a /= b/= c; alpha=beta=gamma=90</td>
</tr>
<tr class="row-odd"><td><strong>3</strong></td>
<td><strong>Tetragonal</strong>: a = b /= c; alpha=beta=gamma=90</td>
</tr>
<tr class="row-even"><td><strong>4</strong></td>
<td><strong>Monoclinic</strong>: a /= b /= c; alpha=beta=90; gamma /= 90</td>
</tr>
<tr class="row-odd"><td><strong>5</strong></td>
<td><strong>Hexagonal</strong>: a = b /= c; alpha=beta=90; gamma=120</td>
</tr>
<tr class="row-even"><td><strong>6</strong></td>
<td><strong>Trigonal</strong>: a=b=c; alpha = beta = gamma /= 90</td>
</tr>
<tr class="row-odd"><td><strong>10</strong></td>
<td>symmetry opearations (enabled automatically when lsymop=.true. &amp; irstrct==0)</td>
</tr>
</tbody>
</table>
<p>irstrct irstrct_sub Type of Sub-restriction on cell
======= =========== ===========================================
<strong>3</strong>   <strong>1</strong>       a = b /= c, alpha = beta = gamma = 90
      <strong>2</strong>       b = c /= a, alpha = beta = gamma = 90
      <strong>other</strong>   c = a /= b, alpha = beta = gamma = 90
<strong>4</strong>   <strong>1</strong>       a /= b /= c, alpha = beta = 90; gamma /= 90
      <strong>2</strong>       a /= b /= c, beta = gamma = 90; alpha /= 90
      <strong>other</strong>   a /= b /= c, gamma = alpha = 90; beta /= 90
<strong>5</strong>   <strong>1</strong>       a = b /= c, alpha = beta = 90; gamma = 120
      <strong>2</strong>       b = c /= a, beta = gamma = 90; alpha = 120
      <strong>other</strong>   c = a /= b, gamma = alpha = 90; beta = 120
======= =========== ===========================================</p>
<p>Defines sub-options for restriction for MD cell in NPT-MD simulations.</p>
</div>
<div class="section" id="md-cell-edge-restriction">
<h3>5.16.23 (MD cell edge restriction)<a class="headerlink" href="#md-cell-edge-restriction" title="Permalink to this headline">¶</a></h3>
<p><strong>lcell_rstrct(1)</strong> = [boolean] <strong>lcell_rstrct(2)</strong> = [boolean]
<strong>lcell_rstrct(3)</strong> = [boolean]</p>
<p>.TRUE. = fix the length of L[1,2,3] .FALSE. = do not fix length</p>
<p>Determines whether or not to fix the lengths of MD cell edges.</p>
</div>
<div class="section" id="shock-wave-velocity">
<span id="id27"></span><h3>5.16.24 (shock wave velocity)<a class="headerlink" href="#shock-wave-velocity" title="Permalink to this headline">¶</a></h3>
<p><strong>shockspeed</strong> = [real] <strong>nshockv(1:3)</strong> = [0|1, 0|1, 0|1]</p>
<p>Default: <strong>shockspeed</strong> = 2000.0 <strong>nshockv(1:3)</strong> = (/1,0,0/)</p>
<p>These variables are only read for MSST (<strong>ifmd</strong> == 10). They define the
shockspeed and the shock direction. For example:</p>
<p><strong>nshockv(1:3)</strong> = 1 0 0: L1 direction <strong>nshockv(1:3)</strong> = 0 1 0: L2
direction <strong>nshockv(1:3)</strong> = 0 0 1: L3 direction <strong>nshockv(1:3)</strong> = 1 1
0: L1 + L2 direction</p>
</div>
<div class="section" id="clear-barostat-velocity">
<span id="id28"></span><h3>5.16.25 (clear barostat velocity)<a class="headerlink" href="#clear-barostat-velocity" title="Permalink to this headline">¶</a></h3>
<p><strong>lmsstscale</strong> = [boolean] <strong>msstscnum</strong> = [integer] <strong>msstscstp</strong> =
[integer]</p>
<p>Default: <strong>lmsstscale</strong> = .FALSE. <strong>msstscnum</strong> = 20 <strong>msstscstp</strong> = 500</p>
<p>These variables are only read for MSST (<strong>ifmd</strong> == 10).</p>
</div>
<div class="section" id="initial-barostat-velocity">
<span id="id29"></span><h3>5.16.26 (initial barostat velocity)<a class="headerlink" href="#initial-barostat-velocity" title="Permalink to this headline">¶</a></h3>
<p><strong>vxmsst</strong> = [real]</p>
<p>Default: <strong>vxmsst</strong> = 0.0</p>
<p>Defines the initial barostat velocity. Only read for MSST (<strong>ifmd</strong> ==
10).</p>
</div>
<div class="section" id="output-data">
<span id="id30"></span><h3>5.16.27 (output data)<a class="headerlink" href="#output-data" title="Permalink to this headline">¶</a></h3>
<p><strong>ioskip</strong> = [integer] <strong>locoor, ioskipcoor</strong> = [boolean, integer]</p>
<p>Defines what data to output for MD-nodes.</p>
</div>
<div class="section" id="charge-estimation">
<span id="id31"></span><h3>5.16.28 (charge estimation)<a class="headerlink" href="#charge-estimation" title="Permalink to this headline">¶</a></h3>
<p><strong>ichest</strong> = [integer]</p>
<p>Default: <strong>ichest</strong> = 3</p>
<p>Number of previous steps</p>
</div>
<div class="section" id="wavefunction-estimation">
<span id="id32"></span><h3>5.16.29 (wavefunction estimation)<a class="headerlink" href="#wavefunction-estimation" title="Permalink to this headline">¶</a></h3>
<p><strong>ihest</strong> = [integer]</p>
<p>Number of previous steps</p>
</div>
<div class="section" id="aspc-charge-estimation">
<span id="id33"></span><h3>5.16.30 (ASPC charge estimation)<a class="headerlink" href="#aspc-charge-estimation" title="Permalink to this headline">¶</a></h3>
<p><strong>laspc_chg</strong> = [boolean]</p>
<p>.TRUE. = ASPC predictor .FALSE. = usual extrapolation</p>
</div>
<div class="section" id="aspc-wavefunction-estimation">
<span id="id34"></span><h3>5.16.31 (ASPC wavefunction estimation)<a class="headerlink" href="#aspc-wavefunction-estimation" title="Permalink to this headline">¶</a></h3>
<p><strong>laspc_wv</strong> = [boolean]</p>
<p>.TRUE. = ASPC predictor .FALSE. = subspace alignment</p>
</div>
<div class="section" id="aspc-acceleration">
<span id="id35"></span><h3>5.16.32 (ASPC acceleration)<a class="headerlink" href="#aspc-acceleration" title="Permalink to this headline">¶</a></h3>
<p><strong>laspc</strong> = [boolean]</p>
<p>.TRUE. = do ASPC</p>
</div>
<div class="section" id="extended-lagrangian-scheme">
<span id="id36"></span><h3>5.16.33 (Extended Lagrangian scheme)<a class="headerlink" href="#extended-lagrangian-scheme" title="Permalink to this headline">¶</a></h3>
<p><strong>lxlbomd</strong> = [boolean]</p>
<p>.TRUE. : time reversible XL-BOMD</p>
</div>
<div class="section" id="previous-values">
<span id="id37"></span><h3>5.16.34 (previous values)<a class="headerlink" href="#previous-values" title="Permalink to this headline">¶</a></h3>
<p><strong>kxlbomd</strong> = [integer]</p>
<p>Number of previous values. If 0, kxlbomd = ihest.</p>
</div>
<div class="section" id="aspc-parameter-for-corrector">
<span id="id38"></span><h3>5.16.35 (ASPC parameter for corrector)<a class="headerlink" href="#aspc-parameter-for-corrector" title="Permalink to this headline">¶</a></h3>
<p><strong>aspc_corr</strong> = [real]</p>
<p>Default: <strong>aspc_corr</strong> = 0.0</p>
</div>
<div class="section" id="aspc-mixing-charge">
<span id="id39"></span><h3>5.16.36 (ASPC mixing charge)<a class="headerlink" href="#aspc-mixing-charge" title="Permalink to this headline">¶</a></h3>
<p><strong>aslh_aspc, bslh_aspc</strong> = [real, real]</p>
</div>
<div class="section" id="aspc-iterations">
<span id="id40"></span><h3>5.16.37 (ASPC iterations)<a class="headerlink" href="#aspc-iterations" title="Permalink to this headline">¶</a></h3>
<p><strong>iscfmx_aspc</strong> = [integer]</p>
<p>Gives the number of iterations.</p>
</div>
<div class="section" id="aspc-tolerance">
<span id="id41"></span><h3>5.16.38 (ASPC tolerance)<a class="headerlink" href="#aspc-tolerance" title="Permalink to this headline">¶</a></h3>
<p><strong>tolres_aspc</strong> = [real]</p>
<p>Gives the tolerance for the residual.</p>
</div>
<div class="section" id="aspc-correction-skip-step">
<span id="id42"></span><h3>5.16.39 (ASPC correction skip step)<a class="headerlink" href="#aspc-correction-skip-step" title="Permalink to this headline">¶</a></h3>
<p><strong>nskp_aspc</strong> = [integer]</p>
</div>
<div class="section" id="planewave-expansion">
<span id="id43"></span><h3>5.16.40 (planewave expansion)<a class="headerlink" href="#planewave-expansion" title="Permalink to this headline">¶</a></h3>
<p><strong>pwscale</strong> = [real]</p>
<p>only for NPT-MD (ifmd == 4 )</p>
</div>
<div class="section" id="statistical-calculation">
<span id="id44"></span><h3>5.16.41 (statistical calculation)<a class="headerlink" href="#statistical-calculation" title="Permalink to this headline">¶</a></h3>
<p><strong>lstat</strong> = [boolean]</p>
</div>
<div class="section" id="id45">
<span id="id46"></span><h3>5.16.42 (tolerance)<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h3>
<p><strong>tol_energy</strong> = [real] <strong>tol_force</strong> = [real]</p>
<p>tolerance for CG optimization (ifmd == 1 ). <strong>tol_energy</strong> given in
energy/atom in [a.u.]. <strong>tol_force</strong> gives maximum force in [a.u.].</p>
</div>
</div>
<div class="section" id="save-data">
<span id="id47"></span><h2>5.17 save data<a class="headerlink" href="#save-data" title="Permalink to this headline">¶</a></h2>
<div class="section" id="onoff">
<span id="id48"></span><h3>5.17.1 (On/Off)<a class="headerlink" href="#onoff" title="Permalink to this headline">¶</a></h3>
<p><strong>lsave</strong> = [boolean]</p>
<p>Default: <strong>lsave</strong> = .TRUE.</p>
<p>Whether or not to save data…which data?</p>
</div>
<div class="section" id="data-type">
<span id="id49"></span><h3>5.17.2 (data type)<a class="headerlink" href="#data-type" title="Permalink to this headline">¶</a></h3>
<p><strong>lsreal8</strong> = [boolean]</p>
<p>Default: <strong>lsreal8</strong> = .TRUE.</p>
<p>.TRUE. : Saves data as real<em>8 .FALSE. : Saves data as integer</em>2</p>
<p>Determines the data type for saved data</p>
</div>
</div>
<div class="section" id="soft-walls">
<span id="id50"></span><h2>5.18 soft walls<a class="headerlink" href="#soft-walls" title="Permalink to this headline">¶</a></h2>
<div class="section" id="walls">
<span id="id51"></span><h3>5.18.1 (walls)<a class="headerlink" href="#walls" title="Permalink to this headline">¶</a></h3>
<p><strong>nwalls</strong> = [integer] <strong>wallp</strong> = [real, real, real] <strong>wallv</strong> = [real,
real, real] <strong>wallf</strong> = [real] <strong>nwallp</strong> = [integer]</p>
<p>Default: <strong>nwalls</strong> = 0</p>
<p><strong>nwalls</strong> gives the number of soft walls to be inserted into the
system, followed by that many sets of <strong>wallp</strong>, <strong>wallv</strong>, <strong>wallf</strong>,
<strong>nwallp</strong>, which define each soft wall. <strong>wallp</strong> gives any point on
the wall in [a.u.]. <strong>wallv</strong> gives the normal vector to the wall,
<strong>wallf</strong> gives the strength of repulsive potential, and <strong>nwallp</strong>
gives the power of the repulsive potential.</p>
<p>Example: This defines two soft walls</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">walls</span><span class="p">)</span>
   <span class="mi">2</span>
 <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
  <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span>
  <span class="mf">1.</span><span class="n">d</span><span class="o">-</span><span class="mi">04</span>
  <span class="mi">12</span>
 <span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span>
 <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span>
  <span class="mf">1.</span><span class="n">d</span><span class="o">-</span><span class="mi">04</span>
  <span class="mi">12</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="gravitational-field">
<span id="id52"></span><h2>5.19 gravitational field<a class="headerlink" href="#gravitational-field" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id53">
<span id="id54"></span><h3>5.19.1 (On/Off)<a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h3>
<p><strong>lgravi</strong> = [boolean]</p>
<p>Default: <strong>lgravi</strong> = .FALSE.</p>
<p>Determines whether to apply a gravitational field.</p>
</div>
<div class="section" id="magnitude">
<span id="id55"></span><h3>5.19.2 (magnitude)<a class="headerlink" href="#magnitude" title="Permalink to this headline">¶</a></h3>
<p><strong>gravmag</strong> = [real]</p>
<p>Default: <strong>gravmag</strong> = 0.0</p>
<p>Determines the stength of the gravitational field in units of g = 9.8
[m/s^2]</p>
</div>
<div class="section" id="direction">
<span id="id56"></span><h3>5.19.3 (direction)<a class="headerlink" href="#direction" title="Permalink to this headline">¶</a></h3>
<p><strong>gravdir</strong> = [real, real, real]</p>
<p>Default: <strong>gravdir</strong> = [0.0, 0.0, 0.0]</p>
<p>Determines the direction of the gravitational field.</p>
</div>
</div>
<div class="section" id="mulliken-analysis">
<span id="id57"></span><h2>5.20 Mulliken analysis<a class="headerlink" href="#mulliken-analysis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id58">
<span id="id59"></span><h3>5.20.21 (On/Off)<a class="headerlink" href="#id58" title="Permalink to this headline">¶</a></h3>
<p><strong>lmulken</strong> = [boolean]</p>
</div>
<div class="section" id="skip-step">
<span id="id60"></span><h3>5.20.22 (skip step)<a class="headerlink" href="#skip-step" title="Permalink to this headline">¶</a></h3>
<p><strong>nskpmulk</strong> = [integer]</p>
</div>
<div class="section" id="decompose-overlap-population">
<span id="id61"></span><h3>5.20.23 (decompose overlap population)<a class="headerlink" href="#decompose-overlap-population" title="Permalink to this headline">¶</a></h3>
<p><strong>ldecmpovp</strong> = [boolean]</p>
</div>
<div class="section" id="weights-associated-with-each-atom">
<span id="id62"></span><h3>5.20.24 (weights associated with each atom)<a class="headerlink" href="#weights-associated-with-each-atom" title="Permalink to this headline">¶</a></h3>
<p><strong>lspdatom</strong> = [boolean]</p>
</div>
<div class="section" id="bond-charge">
<span id="id63"></span><h3>5.20.25 (bond charge)<a class="headerlink" href="#bond-charge" title="Permalink to this headline">¶</a></h3>
<p><strong>nbondc</strong> = [integer] <strong>ibondc, ilbondc, jbondc, jlbondc</strong> = [integer
integer integer integer]</p>
</div>
</div>
<div class="section" id="spherical-harmonics-expansion">
<span id="id64"></span><h2>5.21 Spherical Harmonics expansion<a class="headerlink" href="#spherical-harmonics-expansion" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id65">
<span id="id66"></span><h3>5.21.1 (On/Off)<a class="headerlink" href="#id65" title="Permalink to this headline">¶</a></h3>
<p><strong>lsphexp</strong> = [boolean]</p>
<p>Default: <strong>lsphexp</strong> = .FALSE.</p>
<p>Determines whether or not to use spherical harmonics expansion. Note
this is only read for molecular dynamics simulations.</p>
</div>
<div class="section" id="id67">
<span id="id68"></span><h3>5.21.2 (skip step)<a class="headerlink" href="#id67" title="Permalink to this headline">¶</a></h3>
<p><strong>nskpsphexp</strong> = [integer]</p>
<p>Default: <strong>nskpsphexp</strong> = 5</p>
</div>
<div class="section" id="default-radius">
<span id="id69"></span><h3>5.21.3 (default radius)<a class="headerlink" href="#default-radius" title="Permalink to this headline">¶</a></h3>
<p><strong>radsphexp</strong> = [real]</p>
<p>Default: <strong>radsphexp</strong> = 0.0</p>
<p>Gives the default radius in a.u.. If <strong>radsphexp</strong> = 0, slater_r are
used.</p>
</div>
</div>
<div class="section" id="eda">
<span id="id70"></span><h2>5.22 EDA<a class="headerlink" href="#eda" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id71">
<span id="id72"></span><h3>5.22.1 (On/Off)<a class="headerlink" href="#id71" title="Permalink to this headline">¶</a></h3>
<p><strong>leda</strong> = [boolean]</p>
<p>Default: <strong>leda</strong> = .FALSE.</p>
<p>Determines whether or not to perform energy density analysis (EDA). Note
this can only be used in molecular dynamics.</p>
</div>
<div class="section" id="id73">
<span id="id74"></span><h3>5.22.2 (skip step)<a class="headerlink" href="#id73" title="Permalink to this headline">¶</a></h3>
<p><strong>nskpeda</strong> = [intger]</p>
<p>Default: <strong>nskpeda</strong> = 5</p>
<p>Will peform EDA every <strong>nskpeda</strong> steps.</p>
</div>
<div class="section" id="radius-for-grid-eda">
<span id="id75"></span><h3>5.22.3 (radius for grid EDA)<a class="headerlink" href="#radius-for-grid-eda" title="Permalink to this headline">¶</a></h3>
<p><strong>radgeda</strong> = [real]</p>
<p>Default: <strong>radgeda</strong> = 10.0</p>
<p>Gives the radius in a.u. for EDA calculation.</p>
</div>
</div>
<div class="section" id="wannier-function">
<span id="id76"></span><h2>5.23 Wannier function<a class="headerlink" href="#wannier-function" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id77">
<span id="id78"></span><h3>5.23.1 (On/Off)<a class="headerlink" href="#id77" title="Permalink to this headline">¶</a></h3>
<p><strong>lwannier</strong> = [boolean]</p>
<p>Default: <strong>lwannier</strong> = .FALSE.</p>
<p>Determines whether or not to compute maximully localized Wannier
functions.</p>
</div>
<div class="section" id="band-index">
<span id="id79"></span><h3>5.23.2 (band index)<a class="headerlink" href="#band-index" title="Permalink to this headline">¶</a></h3>
<p><strong>iwbnd1, iwbnd2</strong> = [integer] [integer]</p>
<p>Default: <strong>iwbnd1, iwbnd2</strong> = 0 0</p>
<p>Gives the range of band indices to be transformed by Unitary matrix. If
<strong>iwbnd1, iwbnd2</strong> = 0 0, then all occupied bands will be transformed.</p>
</div>
<div class="section" id="id80">
<span id="id81"></span><h3>5.23.3 (iteration)<a class="headerlink" href="#id80" title="Permalink to this headline">¶</a></h3>
<p><strong>iterwan</strong> = [integer]</p>
<p>Default: <strong>iterwan</strong> = 200</p>
<p>Gives the maximum number of iterations.</p>
</div>
<div class="section" id="id82">
<span id="id83"></span><h3>5.23.4 (tolerance)<a class="headerlink" href="#id82" title="Permalink to this headline">¶</a></h3>
<p><strong>tolwan</strong> = [real]</p>
<p>Default: <strong>tolwan</strong> = 1.d-06</p>
<p>Gives the tolerance???</p>
</div>
<div class="section" id="dump-orbitals">
<span id="id84"></span><h3>5.23.5 (dump orbitals)<a class="headerlink" href="#dump-orbitals" title="Permalink to this headline">¶</a></h3>
<p><strong>iwstt1, iwstt2</strong> = [integer] [integer]</p>
<p>Default: <strong>iwstt1, iwstt2</strong> = 1 0</p>
<p>Gives the orbital indices to dump data for. If <strong>iwstt1, iwstt2</strong> = 0 0,
then all orbitals are dumped. If <strong>iwstt1, iwstt2</strong> = 1 0, then no
orbitals are dumped.</p>
</div>
<div class="section" id="orbitals-around-atoms">
<span id="id85"></span><h3>5.23.6 (orbitals around atoms)<a class="headerlink" href="#orbitals-around-atoms" title="Permalink to this headline">¶</a></h3>
<p><strong>natwan</strong> = [integer] <strong>natwno, nwanaa</strong> = [integer] [integer]</p>
<p>Default: <strong>natwan</strong> = 0</p>
<p><strong>natwan</strong> gives the number of focused atoms, followed by that many
lines of <strong>natwno, nwanaa</strong> pairs, where <strong>natwno</strong> is the atom number
and <strong>nwanaa</strong> is the wavefunction number.</p>
</div>
<div class="section" id="id86">
<span id="id87"></span><h3>5.23.7 (skip step)<a class="headerlink" href="#id86" title="Permalink to this headline">¶</a></h3>
<p><strong>nskpwann</strong> = [integer]</p>
<p>Default: <strong>nskpwann</strong> = 5</p>
<p>Gives the number of steps to skip.</p>
</div>
<div class="section" id="output-unitary-matrix">
<span id="id88"></span><h3>5.23.8 (output unitary matrix)<a class="headerlink" href="#output-unitary-matrix" title="Permalink to this headline">¶</a></h3>
<p><strong>loutuni</strong> = [boolean]</p>
<p>Default: <strong>loutuni</strong> = .FALSE.</p>
<p>Determines whether or not to output the unitary matrix.</p>
</div>
</div>
<div class="section" id="conductivity">
<span id="id89"></span><h2>5.24 Conductivity<a class="headerlink" href="#conductivity" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id90">
<span id="id91"></span><h3>5.24.1 (On/Off)<a class="headerlink" href="#id90" title="Permalink to this headline">¶</a></h3>
<p><strong>lconduct</strong> = [boolean]</p>
<p>Default: <strong>lconduct</strong> = .FALSE.</p>
<p>.TRUE. : Execute the conductivity calculation .FASLE. : Do not execute
the conductivity calculation</p>
<p>Determines whether to run the conductivity calculation. At least one of
<strong>ldcconduct</strong> or <strong>lacconduct</strong> is set to .TRUE.</p>
</div>
<div class="section" id="id92">
<span id="id93"></span><h3>5.24.2 (skip step)<a class="headerlink" href="#id92" title="Permalink to this headline">¶</a></h3>
<p><strong>nskpconduct</strong> = [integer]</p>
<p>Default: <strong>nskpconduct</strong> = 5</p>
<p><strong>nskpconduct</strong> is skip step for the conductivity calculation.</p>
</div>
<div class="section" id="id94">
<span id="id95"></span><h3>5.24.3 (unit of energy)<a class="headerlink" href="#id94" title="Permalink to this headline">¶</a></h3>
<p>(ry) or (hr) or (ev)</p>
<p>Default: (ry)</p>
</div>
<div class="section" id="width-of-energy">
<span id="id96"></span><h3>5.24.4 (width of energy)<a class="headerlink" href="#width-of-energy" title="Permalink to this headline">¶</a></h3>
<p><strong>wgconduct</strong> = [real]</p>
<p>Default: <strong>wgconduct</strong> = 0.1</p>
<p>The gaussian broadening is used, alternative to the Delta function.</p>
</div>
<div class="section" id="id97">
<span id="id98"></span><h3>5.24.5 (temperature)<a class="headerlink" href="#id97" title="Permalink to this headline">¶</a></h3>
<p><strong>tempconduct</strong> = [real]</p>
<p>Default: <strong>tempconduct</strong> = 300.0</p>
<p>Temperature in [K]</p>
</div>
<div class="section" id="dc-current-density">
<span id="id99"></span><h3>5.24.6 (DC current density)<a class="headerlink" href="#dc-current-density" title="Permalink to this headline">¶</a></h3>
<p><strong>lconduct</strong> = [boolean]</p>
<p>Default: <strong>ldcconduct</strong> = .FALSE.</p>
<p>.TRUE. : .FASLE. :</p>
<p>???</p>
</div>
<div class="section" id="id100">
<span id="id101"></span><h3>5.24.7 (electric field)<a class="headerlink" href="#id100" title="Permalink to this headline">¶</a></h3>
<p><strong>efconduct</strong> = (/ [real] [real] [real] /)</p>
<p>Default: <strong>efconduct(1:3)</strong> = (/ 0.0 0.0 0.0/)</p>
<p><strong>efconduct(1:3)</strong> is the constant electric-field vector. The unit of
<strong>efconduct(1:3)</strong> is atomic unit.</p>
</div>
<div class="section" id="current-states">
<span id="id102"></span><h3>5.24.8 (current states)<a class="headerlink" href="#current-states" title="Permalink to this headline">¶</a></h3>
<p>(<strong>icband1</strong>, <strong>icband2</strong>) = [integer] [integer]</p>
<p>Default: (<strong>icband1</strong>, <strong>icband2</strong>) = (/ 0, 0 /)</p>
<p>Range of band indices for total current. If both <strong>icband1</strong> and
<strong>icband2</strong> are set to zero, the range is determined automatically.</p>
</div>
<div class="section" id="hole-states">
<span id="id103"></span><h3>5.24.9 (hole states)<a class="headerlink" href="#hole-states" title="Permalink to this headline">¶</a></h3>
<p>(<strong>ichband1</strong>, <strong>ichband</strong>) = [integer] [integer]</p>
<p>Default: (<strong>ichband1</strong>, <strong>ichband2</strong>) = (/ 0, 0 /)</p>
<p>Range of band indices for hole current. If both <strong>ichband1</strong> and
<strong>ichband2</strong> are set to zero, the range is determined automatically.</p>
</div>
<div class="section" id="electron-states">
<span id="id104"></span><h3>5.24.10 (electron states)<a class="headerlink" href="#electron-states" title="Permalink to this headline">¶</a></h3>
<p>(<strong>iceband1</strong>, <strong>iceband</strong>) = [integer] [integer]</p>
<p>Default: (<strong>iceband1</strong>, <strong>iceband2</strong>) = (/ 0, 0 /)</p>
<p>Tange of band indices for electron current. If both <strong>iceband1</strong> and
<strong>iceband2</strong> are set to zero, the range is determined automatically.
Note:</p>
<p>icband1 &lt;= ichband1 &lt;= ichband2 &lt;= iceband1 &lt;= iceband2 &lt;= icband2</p>
</div>
<div class="section" id="output-momentum-matrix">
<span id="id105"></span><h3>5.24.11 (output momentum matrix)<a class="headerlink" href="#output-momentum-matrix" title="Permalink to this headline">¶</a></h3>
<p><strong>lacconduct</strong> = [boolean]</p>
<p>Default: <strong>lacconduct</strong> = .FALSE.</p>
<p>.TRUE. : .FASLE. :</p>
<p>??? to caluculate optical conductivity</p>
</div>
<div class="section" id="id106">
<span id="id107"></span><h3>5.24.12 (unit of energy)<a class="headerlink" href="#id106" title="Permalink to this headline">¶</a></h3>
<p>(ry) or (hr) or (ev)</p>
<p>Default: (ry)</p>
</div>
<div class="section" id="frequency-range">
<span id="id108"></span><h3>5.24.13 (frequency range)<a class="headerlink" href="#frequency-range" title="Permalink to this headline">¶</a></h3>
<p><strong>freqacmx</strong> = [real]</p>
<p>Default: <strong>freqacmx</strong> = 1.0</p>
<p>??? occupied: e_HOMO - <strong>freqacmx</strong> ~ e_HOMO unoccupied: e_LUMO ~ e_LUMO
+ <strong>freqacmx</strong></p>
</div>
<div class="section" id="matrix-states">
<span id="id109"></span><h3>5.24.14 (matrix states)<a class="headerlink" href="#matrix-states" title="Permalink to this headline">¶</a></h3>
<p>(<strong>iceband1</strong>, <strong>iceband</strong>) = [integer] [integer]</p>
<p>Default: (<strong>immtband1</strong>, <strong>immtband2</strong>) = (/ 0, 0 /)</p>
<p>??? range of band indices for mometum matrix Both of <strong>immtband1</strong> and
<strong>immtband2</strong> are zero, the range is determined automatically.</p>
</div>
</div>
<div class="section" id="stress-calculation-only-for-bulk-calculations">
<span id="id110"></span><h2>5.25 stress calculation —— only for bulk calculations<a class="headerlink" href="#stress-calculation-only-for-bulk-calculations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id111">
<span id="id112"></span><h3>5.25.1 (On/Off)<a class="headerlink" href="#id111" title="Permalink to this headline">¶</a></h3>
<p><strong>lstress</strong> = [boolean]</p>
<p>Default: <strong>lstress</strong> = .TRUE.</p>
<p>.TRUE. : Estimate the stress .FASLE. : Do not estimate the stress</p>
<p>Determines whether to estimate the stress.</p>
</div>
<div class="section" id="id113">
<span id="id114"></span><h3>5.25.2 (skip step)<a class="headerlink" href="#id113" title="Permalink to this headline">¶</a></h3>
<p><strong>nskip_stress</strong> = [integer]</p>
<p>Default: <strong>nskip_stress</strong> = 5</p>
<p><strong>nskip_stress</strong> is skip step to estimate the stress.</p>
</div>
</div>
<div class="section" id="dump-charge-density">
<span id="id115"></span><h2>5.26 dump charge density<a class="headerlink" href="#dump-charge-density" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id116">
<span id="id117"></span><h3>5.26.1 (On/Off)<a class="headerlink" href="#id116" title="Permalink to this headline">¶</a></h3>
<p><strong>ldpchg</strong> = [boolean]</p>
<p>Default: <strong>ldpchg</strong> = .FALSE.</p>
<p>.TRUE. : Output charge density .FASLE. : Do not output</p>
<p>Determines whether to output the charge density.</p>
</div>
<div class="section" id="id118">
<span id="id119"></span><h3>5.26.2 (skip step)<a class="headerlink" href="#id118" title="Permalink to this headline">¶</a></h3>
<p><strong>nskip_dpchg</strong> = [integer]</p>
<p>Default: <strong>nskip_dpchg</strong> = 5</p>
<p><strong>nskip_dpchg</strong> is skip step to output the charge density.</p>
</div>
<div class="section" id="output-area">
<span id="id120"></span><h3>5.26.3 (output area)<a class="headerlink" href="#output-area" title="Permalink to this headline">¶</a></h3>
<p><strong>x_min</strong> <strong>x_max</strong> = [real] [real] <strong>y_min</strong> <strong>y_max</strong> = [real] [real]
<strong>z_min</strong> <strong>z_max</strong> = [real] [real]</p>
<p>Default: <strong>x_min</strong> <strong>x_max</strong> = 1.0 0.0 <strong>y_min</strong> <strong>y_max</strong> = 1.0 0.0
<strong>z_min</strong> <strong>z_max</strong> = 1.0 0.0</p>
<p>These parameter specify the area to output the charge density. They are
reduced coordinates. If <strong>[x|y|z]_min</strong> &gt; <strong>[x|y|z]_max</strong>, output are is
the whole space.</p>
</div>
</div>
<div class="section" id="dump-wavefunctions">
<span id="id121"></span><h2>5.27 dump wavefunctions<a class="headerlink" href="#dump-wavefunctions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id122">
<span id="id123"></span><h3>5.27.1 (On/Off)<a class="headerlink" href="#id122" title="Permalink to this headline">¶</a></h3>
<p><strong>ldpwav</strong> = [boolean]</p>
<p>Default: <strong>ldpwav</strong> = .FALSE.</p>
<p>.TRUE. : Output wavefunction .FASLE. : Do not output</p>
<p>Determines whether to output the wavefunction.</p>
</div>
<div class="section" id="bands">
<span id="id124"></span><h3>5.27.2 (bands)<a class="headerlink" href="#bands" title="Permalink to this headline">¶</a></h3>
<p>(<strong>ibstt1</strong>, <strong>ibstt2</strong>) = [integer] [integer]</p>
<p>Default: (<strong>ibstt1</strong>, <strong>ibstt2</strong>) = (/ 0, 0 /)</p>
<p>The wavefunction will be output from <strong>ibstt1</strong> to <strong>ibstt2</strong>.
<strong>ibstt1</strong> and <strong>ibstt2</strong> are the index of bands. If both <strong>ibstt1</strong> and
<strong>ibstt2</strong> are zero, all bands will be output.</p>
</div>
<div class="section" id="id125">
<span id="id126"></span><h3>5.27.3 (skip step)<a class="headerlink" href="#id125" title="Permalink to this headline">¶</a></h3>
<p><strong>nskip_dpwav</strong> = [integer]</p>
<p>Default: <strong>nskip_dpwav</strong> = 5</p>
<p><strong>nskip_dpwav</strong> is skip step to output the wavefunction.</p>
</div>
<div class="section" id="id127">
<span id="id128"></span><h3>5.27.4 (output area)<a class="headerlink" href="#id127" title="Permalink to this headline">¶</a></h3>
<p><strong>x_min</strong> <strong>x_max</strong> = [real] [real] <strong>y_min</strong> <strong>y_max</strong> = [real] [real]
<strong>z_min</strong> <strong>z_max</strong> = [real] [real]</p>
<p>Default: <strong>x_min</strong> <strong>x_max</strong> = 1.0 0.0 <strong>y_min</strong> <strong>y_max</strong> = 1.0 0.0
<strong>z_min</strong> <strong>z_max</strong> = 1.0 0.0</p>
<p>These parameter specify the area to output the wavefunction. They are
reduced coordinates. If <strong>[x|y|z]_min</strong> &gt; <strong>[x|y|z]_max</strong>, output are is
the whole space.</p>
</div>
</div>
<div class="section" id="dump-local-potential">
<span id="id129"></span><h2>5.28 dump local potential<a class="headerlink" href="#dump-local-potential" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id130">
<span id="id131"></span><h3>5.28.1 (On/Off)<a class="headerlink" href="#id130" title="Permalink to this headline">¶</a></h3>
<p><strong>ldppot</strong> = [boolean]</p>
<p>Default: <strong>ldppot</strong> = .FALSE.</p>
<p>.TRUE. : Output local potential .FASLE. : Do not output</p>
<p>Determines whether to output the local potential.</p>
</div>
<div class="section" id="average-plane">
<span id="id132"></span><h3>5.28.2 (average plane)<a class="headerlink" href="#average-plane" title="Permalink to this headline">¶</a></h3>
<p><strong>nav_dppot</strong> = [1|2|3]</p>
<p>Default: <strong>nav_dppot</strong> = 1</p>
<table border="1" class="docutils">
<colgroup>
<col width="72%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>nav_dppot</strong></th>
<th class="head">Plane</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>1</strong></td>
<td>xy</td>
</tr>
<tr class="row-odd"><td><strong>2</strong></td>
<td>yz</td>
</tr>
<tr class="row-even"><td><strong>3</strong></td>
<td>zx</td>
</tr>
</tbody>
</table>
<p>The plane-averaged local potential will be output.</p>
</div>
<div class="section" id="id133">
<span id="id134"></span><h3>5.28.3 (skip step)<a class="headerlink" href="#id133" title="Permalink to this headline">¶</a></h3>
<p><strong>nskip_dppot</strong> = [integer]</p>
<p>Default: <strong>nskip_dppot</strong> = 5</p>
<p><strong>nskip_dppot</strong> is skip step to output the local potential.</p>
</div>
<div class="section" id="id135">
<span id="id136"></span><h3>5.28.4 (output area)<a class="headerlink" href="#id135" title="Permalink to this headline">¶</a></h3>
<p><strong>x_min</strong> <strong>x_max</strong> = [real] [real] <strong>y_min</strong> <strong>y_max</strong> = [real] [real]
<strong>z_min</strong> <strong>z_max</strong> = [real] [real]</p>
<p>Default: <strong>x_min</strong> <strong>x_max</strong> = 1.0 0.0 <strong>y_min</strong> <strong>y_max</strong> = 1.0 0.0
<strong>z_min</strong> <strong>z_max</strong> = 1.0 0.0</p>
<p>These parameter specify the area to output the local potential. They are
reduced coordinates. If <strong>[x|y|z]_min</strong> &gt; <strong>[x|y|z]_max</strong>, output are is
the whole space.</p>
</div>
</div>
<div class="section" id="supercell">
<span id="id137"></span><h2>5.29 supercell<a class="headerlink" href="#supercell" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id138">
<span id="id139"></span><h3>5.29.1 (unit of length)<a class="headerlink" href="#id138" title="Permalink to this headline">¶</a></h3>
<p>(bohr) or (ang)</p>
<p>Default: (bohr)</p>
<p>Determines the unit of supercell (bohr or angstrom). And the supercell
is specified by either cell vector or ‘lengths and angles’. You need
comment out the subsection you do not specify. Note that for cluster
calculations, the supercell has to be ORTHORHOMBIC.</p>
</div>
<div class="section" id="cell-vector">
<span id="id140"></span><h3>5.29.2 (cell vector)<a class="headerlink" href="#cell-vector" title="Permalink to this headline">¶</a></h3>
<p>L1 = [real] [real] [real] L2 = [real] [real] [real] L3 = [real] [real]
[real]</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">10.68</span>   <span class="mf">0.0</span>    <span class="mf">0.0</span>        <span class="p">:</span> <span class="nb">super</span> <span class="n">cell</span> <span class="n">vector</span> <span class="n">L1</span>
 <span class="mf">0.0</span>   <span class="mf">10.68</span>   <span class="mf">0.0</span>        <span class="p">:</span> <span class="nb">super</span> <span class="n">cell</span> <span class="n">vector</span> <span class="n">L2</span>
 <span class="mf">0.0</span>    <span class="mf">0.0</span>   <span class="mf">10.68</span>       <span class="p">:</span> <span class="nb">super</span> <span class="n">cell</span> <span class="n">vector</span> <span class="n">L3</span>
</pre></div>
</div>
</div>
<div class="section" id="lengths-angles">
<span id="id141"></span><h3>5.29.3 (lengths &amp; angles)<a class="headerlink" href="#lengths-angles" title="Permalink to this headline">¶</a></h3>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">10.68</span><span class="p">,</span>  <span class="mf">10.68</span><span class="p">,</span>  <span class="mf">10.68</span>  <span class="p">:</span>  <span class="n">lengths</span> <span class="n">of</span> <span class="n">cell</span> <span class="n">vectors</span>
<span class="mf">90.00</span><span class="p">,</span>  <span class="mf">90.00</span><span class="p">,</span>  <span class="mf">90.00</span>  <span class="p">:</span>  <span class="n">angles</span> <span class="n">between</span> <span class="n">cell</span> <span class="n">vec</span><span class="o">.</span> <span class="ow">in</span> <span class="p">[</span><span class="n">deg</span><span class="o">.</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="vacuum">
<span id="id142"></span><h2>5.30 vacuum<a class="headerlink" href="#vacuum" title="Permalink to this headline">¶</a></h2>
<p>This section is mainly used for the double grid method.</p>
<div class="section" id="id143">
<span id="id144"></span><h3>5.30.1 (unit of length)<a class="headerlink" href="#id143" title="Permalink to this headline">¶</a></h3>
<p>(bohr) or (ang)</p>
<p>Defaubr&gt; (bohr)</p>
<p>Determines the unit of vacuum (bohr or angstrom).</p>
</div>
<div class="section" id="id145">
<span id="id146"></span><h3>5.30.2 (On/Off)<a class="headerlink" href="#id145" title="Permalink to this headline">¶</a></h3>
<p><strong>lvacuum(1)</strong>, <strong>vacuum(1)</strong> [boolean] [real] <strong>lvacuum(2)</strong>,
<strong>vacuum(2)</strong> [boolean] [real] <strong>lvacuum(3)</strong>, <strong>vacuum(3)</strong> [boolean]
[real]</p>
<p>Default: <strong>lvacuum(1:3)</strong> = .FALSE. <strong>vacuum(1:3)</strong> = 0.0</p>
<p>If <strong>lvacuum([1|2|3])</strong> is .TRUE., the vaccum is <strong>vacuum([1|2|3])</strong>&lt;
[x|y|z] &lt; [L1|L2|L3].</p>
</div>
<div class="section" id="parameter-in-error-function">
<span id="id147"></span><h3>5.30.3 (parameter in error function)<a class="headerlink" href="#parameter-in-error-function" title="Permalink to this headline">¶</a></h3>
<p><strong>alpha_ldouble_grid_recip</strong> = [real]</p>
<p>Default: <strong>alpha_ldouble_grid_recip</strong> = 0.0</p>
<p>If <strong>alpha_ldouble_grid_recip</strong> is zero, <strong>alpha_ldouble_grid_recip</strong> is
set automatically. <strong>alpha_ldouble_grid_recip</strong> should be about 5.0/(the
length of cell).</p>
</div>
</div>
<div class="section" id="spherical-region">
<span id="id148"></span><h2>5.31 spherical region<a class="headerlink" href="#spherical-region" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id149">
<span id="id150"></span><h3>5.31.1 (On/Off)<a class="headerlink" href="#id149" title="Permalink to this headline">¶</a></h3>
<p><strong>lsphere</strong> = [boolean]</p>
<p>Default: <strong>lsphere</strong> = .FALSE.</p>
<p>.TRUE. : Use spherical region in cluster calculations .FASLE. : Do not
use</p>
</div>
</div>
<div class="section" id="planewaves">
<span id="id151"></span><h2>5.32 planewaves<a class="headerlink" href="#planewaves" title="Permalink to this headline">¶</a></h2>
<div class="section" id="unit-of-cutoff-energy">
<span id="id152"></span><h3>5.32.1 (unit of cutoff energy)<a class="headerlink" href="#unit-of-cutoff-energy" title="Permalink to this headline">¶</a></h3>
<p>(ry) or (hr) or (ev)</p>
<p>Default: (ry)</p>
<p>Determines the unit of cutoff energy.</p>
</div>
<div class="section" id="for-wavefuctions">
<span id="id153"></span><h3>5.32.2 (for wavefuctions)<a class="headerlink" href="#for-wavefuctions" title="Permalink to this headline">¶</a></h3>
<p><strong>ecut</strong> = [real]</p>
<p><strong>ecut</strong> is the cutoff energy to expand wavefunctions.</p>
</div>
<div class="section" id="for-electron-density">
<span id="id154"></span><h3>5.32.3 (for electron density)<a class="headerlink" href="#for-electron-density" title="Permalink to this headline">¶</a></h3>
<p><strong>ecutdens</strong> = [real]</p>
<p>Default: <strong>ecutdens</strong> = 0.0</p>
<p><strong>ecutdens</strong> is the cutoff energy to expand electron density.
<strong>ecutdens</strong> must be greater than <strong>ecutsoft</strong>. if .not.lvand,
<strong>ecutdens</strong> must be equal to <strong>ecutsoft</strong>.</p>
</div>
<div class="section" id="for-soft-part-of-density">
<span id="id155"></span><h3>5.32.4 (for soft part of density)<a class="headerlink" href="#for-soft-part-of-density" title="Permalink to this headline">¶</a></h3>
<p><strong>ecutsoft</strong> = [real]</p>
<p>Default: <strong>ecutorth</strong> = 0.0</p>
<p><strong>ecutsoft</strong> is the cutoff energy to expand soft part of electron
density. It must be greater than ecut, and smaller than ecut*4.</p>
</div>
<div class="section" id="for-orthogonalization">
<span id="id156"></span><h3>5.32.5 (for orthogonalization)<a class="headerlink" href="#for-orthogonalization" title="Permalink to this headline">¶</a></h3>
<p><strong>ecutorth</strong> = [real]</p>
<p>Default: <strong>ecutorth</strong> = 0.0</p>
<p><strong>ecutorth</strong> is the cutoff energy for orthogonalization in CG iteration.</p>
</div>
<div class="section" id="for-charge-density-mixing">
<span id="id157"></span><h3>5.32.6 (for charge density mixing)<a class="headerlink" href="#for-charge-density-mixing" title="Permalink to this headline">¶</a></h3>
<p><strong>ecutc</strong> = [real]</p>
<p>Default: <strong>ecutc</strong> = 0.0</p>
<p><strong>ecutc</strong> is the cutoff energy for charge density mixing.</p>
</div>
</div>
<div class="section" id="double-grid-method">
<span id="id158"></span><h2>5.33 double-grid method<a class="headerlink" href="#double-grid-method" title="Permalink to this headline">¶</a></h2>
<p>[add ref]</p>
<div class="section" id="order-of-cardinal-b-spline">
<span id="id159"></span><h3>5.33.1 (order of cardinal B spline)<a class="headerlink" href="#order-of-cardinal-b-spline" title="Permalink to this headline">¶</a></h3>
<p><strong>iosp</strong> = [integer]</p>
<p>Default: <em>iosp</em> = 3. This number must be an odd integer</p>
</div>
<div class="section" id="id160">
<span id="id161"></span><h3>5.33.2 (unit of cutoff energy)<a class="headerlink" href="#id160" title="Permalink to this headline">¶</a></h3>
<p>(ry) or (hr) or (ev)</p>
<p>Default: (ry)</p>
</div>
<div class="section" id="for-non-periodic-direction">
<span id="id162"></span><h3>5.33.3 (for non-periodic direction)<a class="headerlink" href="#for-non-periodic-direction" title="Permalink to this headline">¶</a></h3>
<p><strong>ecutlong</strong> = [real]</p>
<p>Default: <strong>ecutlong</strong> = 0.0</p>
<p>Cutoff energies for the long-range Coulomb interaction</p>
</div>
<div class="section" id="for-periodic-direction">
<span id="id163"></span><h3>5.33.3 (for periodic direction)<a class="headerlink" href="#for-periodic-direction" title="Permalink to this headline">¶</a></h3>
<p><strong>ecutlong_small</strong> = [real]</p>
<p>Default: <strong>ecutlong_small</strong> = 0.0</p>
<p>Cutoff energies for the long-range Coulomb interaction in the periodic
direction (for wire and surface geometries)</p>
</div>
</div>
<div class="section" id="electronic-bands">
<span id="id164"></span><h2>5.34 electronic bands<a class="headerlink" href="#electronic-bands" title="Permalink to this headline">¶</a></h2>
<div class="section" id="occupied-bands">
<span id="id165"></span><h3>5.34.1 (occupied bands)<a class="headerlink" href="#occupied-bands" title="Permalink to this headline">¶</a></h3>
<p><strong>noband</strong> = [integer]</p>
<p>Default: <strong>noband</strong> = 0</p>
<p>The number of occupied bands should at least be sufficient to
accommodate all the valence electrons in the simulation.</p>
</div>
<div class="section" id="empty-bands">
<span id="id166"></span><h3>5.34.2 (empty bands)<a class="headerlink" href="#empty-bands" title="Permalink to this headline">¶</a></h3>
<p><strong>neband</strong> = [integer]</p>
<p>Default: <strong>neband</strong> = 0</p>
<p>A good rule of thumb is to set neband equal to 10% of occupied bands.</p>
</div>
<div class="section" id="id167">
<span id="id168"></span><h3>5.34.3 (broadening)<a class="headerlink" href="#id167" title="Permalink to this headline">¶</a></h3>
<p><strong>lfermi</strong> = [integer] flag <strong>tfermi</strong> = [real]</p>
<p>Default: <strong>lfermi</strong> = 3 <strong>tfermi</strong> = 2000.0</p>
<p>lfermi = 1 for Non-metallic systems, lfermi = 2 for Fermi smearing,
lfermi = 3 for Gaussian smearing and lfermi &gt; 3 for Methfessel-Paxton
smearing scheme of order lfermi-3</p>
</div>
<div class="section" id="charge-number-of-ion">
<span id="id169"></span><h3>5.34.4 (charge number of ion)<a class="headerlink" href="#charge-number-of-ion" title="Permalink to this headline">¶</a></h3>
<p><strong>ncion</strong> = [integer]</p>
<p>Default: <strong>ncion</strong> = 0. For calculation of electronically non-neutral
systems. The number of electrons is given by <code class="docutils literal notranslate"><span class="pre">nel-ncion</span></code>.
Charged-periodic calculations are perfomed with the uniform background.</p>
</div>
</div>
<div class="section" id="symmetry-operations">
<span id="id170"></span><h2>5.35 Symmetry operations<a class="headerlink" href="#symmetry-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id171">
<span id="id172"></span><h3>5.35.1 (On/Off)<a class="headerlink" href="#id171" title="Permalink to this headline">¶</a></h3>
<p><strong>lsymop</strong> = [boolean]</p>
<p>Default: <strong>lsymop</strong> = .FALSE.</p>
<p>The flag <strong>lsymop</strong> defines if symmetry operations are checked.</p>
</div>
<div class="section" id="unit-cell">
<span id="id173"></span><h3>5.35.2 (unit cell)<a class="headerlink" href="#unit-cell" title="Permalink to this headline">¶</a></h3>
<p><strong>nsymm</strong> = [integer][integer][integer]</p>
<p>Default: <strong>nsymm</strong> = 1 1 1</p>
<p><strong>nsymm</strong> defines the number of unit cells in the x, y and z directions.</p>
<p>The transformation matrix is specified through either (transformation
matrix) or (inverse transformation matrix) as follows.
<code class="docutils literal notranslate"><span class="pre">trsfrm(j,i)</span> <span class="pre">&lt;--</span> <span class="pre">trsfrm(j,i)/nsymm(i)</span></code> or
<code class="docutils literal notranslate"><span class="pre">trsfri(i,j)</span> <span class="pre">&lt;--</span> <span class="pre">trsfri(i,j)*nsymm(i)</span></code></p>
</div>
<div class="section" id="transformation-matrix">
<span id="id174"></span><h3>5.35.3 (transformation matrix)<a class="headerlink" href="#transformation-matrix" title="Permalink to this headline">¶</a></h3>
<p><strong>trsfrm(1,i)</strong> = [real][real][real] <strong>trsfrm(2,i)</strong> =
[real][real][real] <strong>trsfrm(3,i)</strong> = [real][real][real]</p>
<p>Default: <strong>trsfrm</strong> = No defaults</p>
</div>
<div class="section" id="inverse-transformation-matrix">
<span id="id175"></span><h3>5.35.3 (inverse transformation matrix)<a class="headerlink" href="#inverse-transformation-matrix" title="Permalink to this headline">¶</a></h3>
<p><strong>trsfri(1,i)</strong> = [real][real][real] <strong>trsfri(2,i)</strong> =
[real][real][real] <strong>trsfri(3,i)</strong> = [real][real][real]</p>
<p>Default: <strong>trsfri</strong> = No defaults</p>
</div>
<div class="section" id="origin-of-symmetry-op">
<span id="id176"></span><h3>5.35.4 (origin of symmetry op.)<a class="headerlink" href="#origin-of-symmetry-op" title="Permalink to this headline">¶</a></h3>
<p><strong>symm</strong> = [real][real][real]</p>
<p>Default: <strong>symm</strong> = 0.0 0.0 0.0</p>
</div>
<div class="section" id="id177">
<span id="id178"></span><h3>5.35.5 (symmetry operations)<a class="headerlink" href="#id177" title="Permalink to this headline">¶</a></h3>
<p><strong>nmsyop</strong> = [integer] <code class="docutils literal notranslate"><span class="pre">???</span></code></p>
<p>Default: <strong>nmsyop</strong> = 1</p>
</div>
<div class="section" id="denominator-of-trans-vector">
<span id="id179"></span><h3>5.35.6 (denominator of trans. vector)<a class="headerlink" href="#denominator-of-trans-vector" title="Permalink to this headline">¶</a></h3>
<p><strong>denomt</strong> = [real]</p>
<p>Default: <strong>denomt</strong> = No default</p>
</div>
<div class="section" id="inversion-operations">
<span id="id180"></span><h3>5.35.7 (inversion operations)<a class="headerlink" href="#inversion-operations" title="Permalink to this headline">¶</a></h3>
<p><strong>linvsn</strong> = [boolean]</p>
<p>Default: <strong>linvsn</strong> = .FALSE.</p>
</div>
<div class="section" id="radius-to-identify-atoms">
<span id="id181"></span><h3>5.35.8 (radius to identify atoms)<a class="headerlink" href="#radius-to-identify-atoms" title="Permalink to this headline">¶</a></h3>
<p><strong>radsym</strong> = [real]</p>
<p>Default: <strong>radsym</strong> = 1.0</p>
<p>Radius to identify symmetrically equivalent atoms</p>
</div>
<div class="section" id="for-charge-density">
<span id="id182"></span><h3>5.35.9 (for charge density)<a class="headerlink" href="#for-charge-density" title="Permalink to this headline">¶</a></h3>
<p><strong>lsymcd</strong> = [boolean]</p>
<p>Default: <strong>lsymcd</strong> = .FALSE.</p>
</div>
<div class="section" id="for-spin-density">
<span id="id183"></span><h3>5.35.10 (for spin density)<a class="headerlink" href="#for-spin-density" title="Permalink to this headline">¶</a></h3>
<p><strong>lsymspin</strong> = [boolean]</p>
<p>Default: <strong>lsymspin</strong> = No default</p>
</div>
</div>
<div class="section" id="atoms">
<span id="id184"></span><h2>5.36 Atoms<a class="headerlink" href="#atoms" title="Permalink to this headline">¶</a></h2>
<div class="section" id="species">
<span id="id185"></span><h3>5.36.1 (species)<a class="headerlink" href="#species" title="Permalink to this headline">¶</a></h3>
<p><strong>ntype</strong> = [integer]</p>
<p>Default: <strong>ntype</strong> = 0</p>
<p>Number of atom types. The subsequent sections must be duplicated
<code class="docutils literal notranslate"><span class="pre">ntype</span></code> times.</p>
</div>
<div class="section" id="atomic-number">
<span id="id186"></span><h3>5.36.2 (atomic number)<a class="headerlink" href="#atomic-number" title="Permalink to this headline">¶</a></h3>
<p><strong>zatom</strong> = [integer]</p>
<p>Default: <strong>zatom</strong> = No default</p>
<p>Atomic number of the current atom type</p>
</div>
<div class="section" id="pseudopotential">
<span id="id187"></span><h3>5.36.3 (pseudopotential)<a class="headerlink" href="#pseudopotential" title="Permalink to this headline">¶</a></h3>
<p>kbpp or uspp or vand or local</p>
<p>Default: No default</p>
<p>Type of pseudopotential defined for the current atom type.</p>
</div>
<div class="section" id="nonlocal-potential">
<span id="id188"></span><h3>5.36.4 (nonlocal potential)<a class="headerlink" href="#nonlocal-potential" title="Permalink to this headline">¶</a></h3>
<p><strong>lking</strong> = [boolean] <strong>rking</strong> = [real] <strong>gkgmax</strong> = [real] <strong>gkgexct</strong>
= [real]</p>
<p>Default: <strong>lking</strong> = No default <strong>rking</strong> = No default <strong>gkgmax</strong> = No
default <strong>gkgexct</strong> = No default</p>
<p>These flags specify if nonlocal potntial is computed in real space or
reciprocal space. We follow the formalism by [ R. D. King-smith et al.
]. lking=.false. allows calculation to proceed in reciporocal space. In
such case, next three parameter are read but not use. If lking=.true.,
caculation will proceed in real space. In such case, rking, gkgmax and
gkgexct are used. rking corresponds to real space cutoff radius. gkgmax
and gkgexct correspond to accuracy of non-local potentials. For more
detail, please follow paper by R. D. King-smith et al. Accuracy of real
space must be tested if input parameters are not provided.</p>
<p>Recommendation: <strong>lking</strong> = false for small system and true for large
system <strong>rking</strong> = 1.5- 2 <strong>gkgmax</strong> = 1.25 <strong>gkgexct</strong> = 0.98</p>
</div>
<div class="section" id="local-potential">
<span id="id189"></span><h3>5.36.5 (local potential)<a class="headerlink" href="#local-potential" title="Permalink to this headline">¶</a></h3>
<p><strong>llking</strong> = [boolean] <strong>rlking</strong> = [real] <strong>glkgmax</strong> = [real]
<strong>glkgexct</strong> = [real]</p>
<p>Default: <strong>llking</strong> = No default <strong>rlking</strong> = No default <strong>glkgmax</strong> =
No default <strong>glkgexct</strong> = No default</p>
<p>These flags specify if local potntial is computed in real space or
reciprocal space. It is recommended to use reciprocal space reciprocal
space for the calculation. In reciprocal space rlking, glkgmax and
glkgexct are not used but values are read.</p>
<p>Recommendation: <strong>llking</strong> = false</p>
</div>
<div class="section" id="partial-core-correction">
<span id="id190"></span><h3>5.36.6 (partial core correction)<a class="headerlink" href="#partial-core-correction" title="Permalink to this headline">¶</a></h3>
<p><strong>lpcc</strong> = [boolean] <strong>rpcc</strong> = [real] <strong>lpking</strong> = [boolean] <strong>rpking</strong>
= [real] <strong>gpkgmax</strong> = [real] <strong>gpkgexct</strong> = [real]</p>
<p>Default: <strong>lpcc</strong> = No default <strong>rpcc</strong> = No default <strong>lpking</strong> = No
default <strong>rpking</strong> = No default <strong>gpkgmax</strong> = No default <strong>gpkgexct</strong> =
No default</p>
<p>Psuedopotential formalism treat core and valence electron seperately.
Partial core correction includes the effect of core charge as a
perturbation which increase the transferrability of the code. It is
recommended to use partial core correction. Please see paper by Louie et
al.</p>
</div>
<div class="section" id="compensation-charge-cutoff">
<span id="id191"></span><h3>5.36.7 (compensation charge cutoff)<a class="headerlink" href="#compensation-charge-cutoff" title="Permalink to this headline">¶</a></h3>
<p><strong>frac_rcomp_it</strong> = [real]</p>
<p>Default: <strong>frac_rcomp_it</strong> = 1.3</p>
<p>Compensation charge must be used in PAW method to match all electron
wave function. A recommended value is between 1.2 - 1.3. For more detail
please see paper by Kresse et al.</p>
</div>
<div class="section" id="the-number-of-atoms">
<span id="id192"></span><h3>5.36.8 (the number of atoms)<a class="headerlink" href="#the-number-of-atoms" title="Permalink to this headline">¶</a></h3>
<p><strong>nhk</strong> = [integer]</p>
<p>Default: <strong>nhk</strong> = 0</p>
<p>Number of atoms of the current type. If <code class="docutils literal notranslate"><span class="pre">nhk</span></code> is zero, then atomic
configuration is read from the positions file</p>
</div>
<div class="section" id="id193">
<span id="id194"></span><h3>5.36.9 (unit of length)<a class="headerlink" href="#id193" title="Permalink to this headline">¶</a></h3>
<p>(bohr) or (ang)</p>
<p>Default: No default</p>
</div>
<div class="section" id="position-file">
<span id="id195"></span><h3>5.36.10 (position file)<a class="headerlink" href="#position-file" title="Permalink to this headline">¶</a></h3>
<p><strong>fname</strong> = [String] <strong>scaledflag</strong>* = [integer] <strong>keyword</strong>* =
[integer]</p>
<p>Default: <strong>fname</strong> = No default <strong>scaledflag</strong>* = No default
<strong>keyword</strong>* = No default</p>
<p>Filename to read atomic positions from. Filenames are given with
reference to the current working directory. <strong>scaledflag</strong> determines if
the aomtic positions in the coordinate file are in real or scaled units.
Atoms of this type are denoted by the integer <strong>keyword</strong> in the
corrdinates file.</p>
<p>The structure of ‘CONFIGURATION_FILE’ is as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ntotal</span>
<span class="n">n_1</span>      <span class="n">x_1</span>      <span class="n">y_1</span>      <span class="n">z_1</span>
<span class="n">n_2</span>      <span class="n">x_2</span>      <span class="n">y_2</span>      <span class="n">z_2</span>
<span class="o">...</span>      <span class="o">...</span>      <span class="o">...</span>      <span class="o">...</span>
<span class="n">n_ntotal</span> <span class="n">x_ntotal</span> <span class="n">y_ntotal</span> <span class="n">z_ntotal</span>
</pre></div>
</div>
<p>The coordinates for (n_i == keyword) are selected.</p>
</div>
<div class="section" id="positions">
<span id="id196"></span><h3>5.36.11 (positions)<a class="headerlink" href="#positions" title="Permalink to this headline">¶</a></h3>
<p><strong>nunitcells</strong> = [integer][integer][integer] <strong>scaledflag</strong>* =
[integer] <code class="docutils literal notranslate"><span class="pre">nhk</span></code> lines of <strong>positions</strong> = [real][real][real]</p>
<p>Default: <strong>nunitcells</strong> = No defaults <strong>scaledflag</strong>* = No defaults</p>
<p><strong>nunitcells</strong> gives the number of unit cells along the x, y and z
directions. The flag <strong>scaledflag</strong> defines if the atomic positions are
defined in real or scaled coordinates (<strong>scaledflag</strong> = 1 is scaled
coordinates, <strong>scaledflag</strong> = 2 is real coordinates).</p>
<p>If ‘1 (scaled)’ is selected, the scaled coordinates ( 0.0 &lt; x,y,z &lt; 1.0
) have to be given above. If ‘2 (real)’ is selected, the real
coordinates ( in a.u. ) have to be given like below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">2</span>                            <span class="p">:</span> <span class="mi">1</span><span class="p">:</span><span class="n">scaled</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="n">real</span> <span class="n">coordinates</span>
  <span class="mf">0.00</span><span class="n">d0</span>  <span class="mf">0.00</span><span class="n">d0</span>  <span class="mf">0.00</span><span class="n">d0</span>      <span class="p">:</span> <span class="n">If</span> <span class="s1">&#39;2 (real)&#39;</span> <span class="ow">is</span> <span class="n">selected</span><span class="p">,</span>
 <span class="mf">10.34</span><span class="n">d0</span> <span class="mf">10.34</span><span class="n">d0</span> <span class="mf">10.34</span><span class="n">d0</span>      <span class="p">:</span>  <span class="n">the</span> <span class="n">real</span> <span class="n">coordinates</span> <span class="p">(</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">u</span><span class="o">.</span> <span class="p">)</span>
 <span class="mf">10.34</span><span class="n">d0</span>  <span class="mf">0.00</span><span class="n">d0</span> <span class="mf">10.34</span><span class="n">d0</span>      <span class="p">:</span>  <span class="n">have</span> <span class="n">to</span> <span class="n">be</span> <span class="n">given</span><span class="o">.</span>
<span class="mf">0.00</span><span class="n">d0</span> <span class="mf">10.34</span><span class="n">d0</span> <span class="mf">10.34</span><span class="n">d0</span>
</pre></div>
</div>
</div>
<div class="section" id="fix-positions">
<span id="id197"></span><h3>5.36.12 (fix positions)<a class="headerlink" href="#fix-positions" title="Permalink to this headline">¶</a></h3>
<p><strong>lfixion</strong> = [boolean]</p>
<p>Default: <strong>lfixion</strong> = .FALSE.</p>
<p>If .TRUE., atoms of current type are held fixed by setting atomic
velocities to zero.</p>
</div>
<div class="section" id="fix-displacement">
<span id="id198"></span><h3>5.36.13 (fix displacement)<a class="headerlink" href="#fix-displacement" title="Permalink to this headline">¶</a></h3>
<p><strong>ldispion</strong> = [boolean] <strong>dvector</strong> = [real] [real] [real]</p>
<p>Default: <strong>ldispion</strong> = .FALSE. <strong>dvector</strong> = No default</p>
<p>If .TRUE., positions of atoms of current type are updated by adding
<strong>dvector</strong> to the current position. <code class="docutils literal notranslate"><span class="pre">???</span></code></p>
</div>
<div class="section" id="fictitious-mass">
<span id="id199"></span><h3>5.36.14 (fictitious mass)<a class="headerlink" href="#fictitious-mass" title="Permalink to this headline">¶</a></h3>
<p><strong>ficmass</strong> = [real]</p>
<p>Default: <strong>ficmass</strong> = 1.0</p>
<p>If set, the mass of atoms of this type are scaled by <strong>ficmass</strong></p>
</div>
<div class="section" id="velocity-file">
<span id="id200"></span><h3>5.36.15 (velocity file)<a class="headerlink" href="#velocity-file" title="Permalink to this headline">¶</a></h3>
<p><strong>fname</strong> = [String] <strong>keyword</strong>* = [integer]</p>
<p>Default: <strong>fname</strong> = No default <strong>keyword</strong>* = No default</p>
<p><strong>fname</strong> is the filename to read atomic velocities from. Filename is
given with reference to the current working directory. Atoms of this
type are denoted by the integer <strong>keyword</strong> in the velocities file.</p>
<p>The structure of ‘VELOCITY_FILE’ is as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ntotal</span>
<span class="n">vmax</span>                              <span class="p">:</span> <span class="n">maximum</span> <span class="n">velocity</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">u</span><span class="o">.</span><span class="p">)</span>
<span class="n">n_1</span>      <span class="n">vx_1</span>      <span class="n">vy_1</span>      <span class="n">vz_1</span> <span class="p">:</span> <span class="n">an</span> <span class="n">integer</span> <span class="o">&amp;</span> <span class="n">scaled</span> <span class="n">velocity</span>
<span class="n">n_2</span>      <span class="n">vx_2</span>      <span class="n">vy_2</span>      <span class="n">vz_2</span>
<span class="o">...</span>      <span class="o">...</span>       <span class="o">...</span>       <span class="o">...</span>
<span class="n">n_ntotal</span> <span class="n">vx_ntotal</span> <span class="n">vy_ntotal</span> <span class="n">vz_ntotal</span>
</pre></div>
</div>
<p>The velocities for (n_i == keyword) are selected.</p>
</div>
<div class="section" id="velocities">
<span id="id201"></span><h3>5.36.16 (velocities)<a class="headerlink" href="#velocities" title="Permalink to this headline">¶</a></h3>
<p><strong>nunitcells</strong> = [integer][integer][integer] <strong>scalingfactor</strong>* =
[real] <code class="docutils literal notranslate"><span class="pre">nhk</span></code> lines of scaled <strong>velocities</strong> = [real][real][real] .
Ensure that -1.0 &lt; <strong>velocities</strong> &lt; 1.0</p>
<p>Default: <strong>nunitcells</strong> = No defaults <strong>scalingfactor</strong>* = No
defaults</p>
<p><strong>nunitcells</strong> gives the number of unit cells along the x, y and z
directions. Atomic velocities are initialized by multiplying the vector
<strong>velocities</strong> by the <strong>scalingfactor</strong>.</p>
</div>
<div class="section" id="id202">
<span id="id203"></span><h3>5.36.17 (Spherical Harmonics expansion)<a class="headerlink" href="#id202" title="Permalink to this headline">¶</a></h3>
<p><strong>rsphexp</strong> = [real]</p>
<p>Default: <strong>rsphexp</strong> = No default</p>
<p>Radius for <em>Ylm</em> expansion</p>
</div>
<div class="section" id="id204">
<span id="id205"></span><h3>5.36.18 (EDA)<a class="headerlink" href="#id204" title="Permalink to this headline">¶</a></h3>
<p><strong>radeda</strong> = [real]</p>
<p>Default: <strong>radeda</strong> = No default</p>
<p>Radius for EDA</p>
</div>
<div class="section" id="atomic-charge">
<span id="id206"></span><h3>5.36.19 (atomic charge)<a class="headerlink" href="#atomic-charge" title="Permalink to this headline">¶</a></h3>
<p><strong>rintchg</strong> = [real]</p>
<p>Default: <strong>rintchg</strong> = No default</p>
<p>Radius of integration to calculate atomic charge</p>
</div>
<div class="section" id="dftu">
<span id="id207"></span><h3>5.36.20 (DFT+U)<a class="headerlink" href="#dftu" title="Permalink to this headline">¶</a></h3>
<p><strong>lplusU_at</strong> = [boolean] <strong>plusU_l</strong> = [integer] <strong>plusU_U</strong> = [real]
<strong>plusU_J</strong> = [real]</p>
<p>Default: <strong>lplusU_at</strong> = .FALSE. <strong>plusU_l</strong> = 2 <strong>plusU_U</strong> = 0.0
<strong>plusU_J</strong> = 0.0</p>
<p>The flag <strong>lplusU_at</strong> determines if the DFT+U method is used.
<strong>plusU_l</strong> defines the angular momentum quantum number of the orbital
of interest. <strong>plusU_U</strong> and <strong>plusU_J</strong> define the Hubbard parameter U
and the screened exchange energy in electron-volts.</p>
</div>
<div class="section" id="dftc">
<span id="id208"></span><h3>5.36.21 (DFT+C)<a class="headerlink" href="#dftc" title="Permalink to this headline">¶</a></h3>
<p><strong>lplusC_at</strong> = [boolean] <strong>plusC_r_e_s</strong> = [real] [real]
<strong>plusC_r_e_p</strong> = [real] [real] <strong>plusC_r_e_d</strong> = [real] [real]
<strong>plusC_r_e_f</strong> = [real] [real]</p>
<p>Default: <strong>lplusC_at</strong> = .FALSE. <strong>plusC_r_e_s</strong> = 0.0 0.0
<strong>plusC_r_e_p</strong> = 0.0 0.0 <strong>plusC_r_e_d</strong> = 0.0 0.0 <strong>plusC_r_e_f</strong> =
0.0 0.0</p>
<p>The flag <strong>lplusC_at</strong> determines if the DFT+C method is used.
<strong>plusC_r_e</strong> defines the <code class="docutils literal notranslate"><span class="pre">plusC_r</span></code> and <code class="docutils literal notranslate"><span class="pre">plusC_e</span></code> vales for the s,
p, d and f subshells.</p>
<p>The form of correction</p>
<p><code class="docutils literal notranslate"><span class="pre">modified</span> <span class="pre">V_nl(r)</span> <span class="pre">=</span> <span class="pre">V_nl(r)</span> <span class="pre">+</span> <span class="pre">plusC_e</span> <span class="pre">*</span> <span class="pre">sin(a*r)/(a*r),</span> <span class="pre">a</span> <span class="pre">=</span> <span class="pre">pi/plusC_r</span></code></p>
<p>where <code class="docutils literal notranslate"><span class="pre">plusC_r</span></code> is cutoff radius in [a.u.] and <code class="docutils literal notranslate"><span class="pre">plusC_e</span></code> is energy
shift in [Ryd.]</p>
</div>
</div>
<div class="section" id="constraint-conditions">
<span id="id209"></span><h2>5.37 Constraint conditions<a class="headerlink" href="#constraint-conditions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id210">
<span id="id211"></span><h3>5.37.1 (unit of length)<a class="headerlink" href="#id210" title="Permalink to this headline">¶</a></h3>
<p>(bohr) or (ang)</p>
<p>Default: (ang)</p>
</div>
<div class="section" id="bond-length-constraint">
<span id="id212"></span><h3>5.37.1 (bond length constraint)<a class="headerlink" href="#bond-length-constraint" title="Permalink to this headline">¶</a></h3>
<p><strong>ncbonds</strong> = [integer]</p>
<p>Followed by <strong>ncbonds</strong> lines of constraints.</p>
<p><strong>ncbatm1</strong> = [integer] <strong>ncbatm2</strong> = [integer] <strong>cblength</strong> = [real]</p>
<p>For each line, the bond length between <strong>ncbatm1</strong> and <strong>ncbatm2</strong> is
held fixed at <strong>cblength</strong> Angstrom.</p>
<p>Default: <strong>ncbonds</strong> = 0 <strong>ncbatm1</strong> = No default <strong>ncbatm2</strong> = No
default <strong>cblength</strong> = No default</p>
</div>
</div>
<div class="section" id="virtual-molecular-dynamics">
<span id="id213"></span><h2>5.38 Virtual Molecular Dynamics<a class="headerlink" href="#virtual-molecular-dynamics" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="cholesky-decomposition">
<span id="id214"></span><h2>5.39 Cholesky decomposition<a class="headerlink" href="#cholesky-decomposition" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-number-of-nodes">
<span id="id215"></span><h3>5.39.1 (the number of nodes)<a class="headerlink" href="#the-number-of-nodes" title="Permalink to this headline">¶</a></h3>
<p><strong>node_c</strong> = [integer]</p>
<p>Default: <strong>node_c</strong> = 4</p>
</div>
</div>
<div class="section" id="eigenvalue-problem">
<span id="id216"></span><h2>5.40 Eigenvalue problem<a class="headerlink" href="#eigenvalue-problem" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id217">
<span id="id218"></span><h3>5.40.1 (the number of nodes)<a class="headerlink" href="#id217" title="Permalink to this headline">¶</a></h3>
<p><strong>node_r</strong> = [integer]</p>
<p>Default: <strong>node_r</strong> = 4</p>
</div>
</div>
<div class="section" id="work-array">
<span id="id219"></span><h2>5.41 Work Array<a class="headerlink" href="#work-array" title="Permalink to this headline">¶</a></h2>
<div class="section" id="size-of-array">
<span id="id220"></span><h3>5.41.1 (size of array)<a class="headerlink" href="#size-of-array" title="Permalink to this headline">¶</a></h3>
<p><strong>dblock</strong> = [real]</p>
<p>Default: <strong>dblock</strong> = 1.d+07</p>
</div>
</div>
<div class="section" id="table-dimension">
<span id="id221"></span><h2>5.42 Table Dimension<a class="headerlink" href="#table-dimension" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id222">
<span id="id223"></span><h3>5.42.1 (local potential)<a class="headerlink" href="#id222" title="Permalink to this headline">¶</a></h3>
<p><strong>mx1loc</strong> = [integer]</p>
<p>Default: <strong>mx1loc</strong> = 2**13</p>
</div>
<div class="section" id="others">
<span id="id224"></span><h3>5.42.2 (others)<a class="headerlink" href="#others" title="Permalink to this headline">¶</a></h3>
<p><strong>mx1</strong> = [integer]</p>
<p>Default: <strong>mx1</strong> = 2**13</p>
<br><hr class="docutils" />
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Subodh Tiwari &amp; Lindsay Bassman

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>