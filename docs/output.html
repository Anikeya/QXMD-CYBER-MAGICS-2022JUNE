

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>QXMD Simulation Quick-Start &mdash; QXMD 3.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utilities" href="util.html" />
    <link rel="prev" title="Input Parameters: IN.PARAM" href="param.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> QXMD
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="program.html">Program Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="IOf.html">Input/Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="param.html">Input Parameters: IN.PARAM</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">QXMD Simulation Quick-Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#minimal-in-param-file">6.1 Minimal IN.PARAM file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-parameters-to-in-param">6.2 Adding parameters to IN.PARAM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="util.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="lic.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QXMD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>QXMD Simulation Quick-Start</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="qxmd-simulation-quick-start">
<h1>QXMD Simulation Quick-Start<a class="headerlink" href="#qxmd-simulation-quick-start" title="Permalink to this headline">¶</a></h1>
<p>The <strong>Examples</strong> directory holds examples of various QXMD simulations
for a variety of systems. Examining the input files in these examples
may be the best way to begin to get an intuition for how to run your
first QXMD simulation. While all the input parameters are given in
section 5, many of these parameters have default settings that need not
be changed, and many of the input sections can be left out of the input
file for many standard (simple) QXMD simulations. Thus, what follows can
be viewed as a quick-start guide for getting your first QXMD simulation
running as soon as possible. To run more complex simulations, the reader
should refer to input parameter settings in Section 5 and sample input
files given in the <strong>Examples</strong> directory.</p>
<div class="section" id="minimal-in-param-file">
<h2>6.1 Minimal IN.PARAM file<a class="headerlink" href="#minimal-in-param-file" title="Permalink to this headline">¶</a></h2>
<p>Given below is an sample input file for the optimization of a water
molecule which includes all the most important input parameters for
running standard QXMD simulations. Most users will find this input file
sufficient for running optimization and quantum molecular dynamics jobs.
Of course, input parameters given in section 5 can be added to this
input file (an example of how to add a new section of variables will be
shown in the next section on running a non-adiabatic QMD simulation) to
tailor a QXMD job to the user’s specifications.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>---(Input-parameter file for QXMD)---
                              :
*parallel                     :
(QM-nodes)                    :
  1  1  1                     : (npx, npy, npz)
(MD-nodes)                    :
  1  1  1                     : (md_npx, md_npy, md_npz)
*end                          :
                              :
                              :
*start(on/off)                :
(how of it)                   :
 .false.                       : (lstart) .true. = restart
*end                          :
                              :
                              :
*approximation for Exc        :
(approximation)               :
       2                      : (jgga) = 1:LDA, 2:GGA(PBE), 3:GGA(RPBE),
                              :          4:GGA(revPBE), 5:vdW-DF, 6:vdW-DF2
                              :
(DFT-D)                       : an empirical correction for the vdW interaction
 .true.                       : (ldftd) .true. = on, .false. = off
                              :
*end                          :
                              :
                              :
                              :
*SCF iterations               :
(global iterations)           :
     100                      : (iscfmx) maximum No. of global iterations
(tolerances)                  :
      3.0d-08                 : (tolpot) tolerance for total energy
      5.0d-08                 : (tolres) tolerance for average residual
*end                          :
                              :
                              :
*molecular dynamics           :
(how of it)                   :
   1                          : (ifmd)
                              :   0:non, 1:optimization, 2:NVE, 3:NVT, 4:NPT
(time step)                   :
   50.0d0   1000               : (dtmd, nstop) time step, total step
(temperature)                 : only for real dynamics (NVE-, NVT-, NPT-MD )
   300.d0                     : (treq) temperature in [K]
(check temperature)           :
  .true.                     : (liscale) .true. = Do it !
   25                         : (iscnum)  number of temperature check
   20                         : (iscstp)  skip step
                              :
(optimization)                : only for structural optimization (ifmd == 1 )
    2                         : (ioptmze)
                              :  -1: do not optimize atomic coordinates
                              :   0: Conjugate gradient
                              :   1: Projected velocity Verlet
                              :   2: Quasi-Newton method with BFGS formula
                              :
(stabilizer for quasi-Newton) : only for quasi-Newton method (ifmd==1 &amp; ioptmze==2)
   0.1d0                      : (gammamin)
                              :
(clear Hessian)               : only for quasi-Newton method (ifmd==1 &amp; ioptmze==2)
    0                         : (ibfgsclear) clear Hessian every ibfgsclear step
                              :           if ibfgsclear == 0, Hessian is not cleared.
                              :
(atomic stress &amp; energy)      : only for MD nodes
 .true.                       : (latomic) .true. = output atomic stress &amp; energy
                              : Note that nskip_atomic = ioskip
                              : When lstress = false, atomic stress is not output.
                              :
(tolerance)                   : tolerance for CG optimization (ifmd == 1 )
  1.d-07                      : (tol_energy) energy/atom in [a.u.]
  5.d-04                      : (tol_force ) max. force  in [a.u.]
                              :
(output data)                 : only for MD nodes
    1                         : (ioskip)  skip step
 .true.    1                  : (locoor, ioskipcoor) scaled coordinates
 .false.    1                  : (lovelo, ioskipvelo) scaled velocities
 .false.    1                  : (loforc, ioskipforc) scaled forces
*end                          :
------------------------------:---------------------------------------
*supercell                    :
(unit of length)              :
(ang)                         : (bohr) or (ang)
                              :
(lengths &amp; angles)            :
7.00d0, 7.00d0, 5.0d0         :  lengths of cell vectors
90.000,  90.000,  90.000  :  angles between cell vec. in [deg.]
*end                          :
                              :
*planewaves                   :
(unit of cutoff energy)       :
(ry)                          : (ry) or (hr) or (ev)
(for wavefunctions)           :
  30.0                        : (ecut)
(for electron density)        :
 250.0                        : (ecutdens)
(for soft part of density)    :
 70.0                         : (ecutsoft)
*end                          :
                              :
*electronic bands             :
(occupied bands)              :
      8                     : (noband)  No. of occupied bands
(empty bands)                 :
      2                     : (neband)  No. of empty bands
                              :           total No.= noband + neband
(broadening)                  :
       3    500.d0            : (lfermi) = 1:nonmetallic, 2:Fermi, 3:Gaussian,
                              :   lfermi(&gt;3):Methfessel &amp; Paxton, order=lfermi-3
                              : (tfermi) = electronic temp.(K), if metallic
*end                          :
                              :
------------------------------:---------------------------------------
*atoms                        :
(species)                     :
  2                           : (ntype) No. of atomic species
==============================:=======================================
(atomic number)               :
  8.0                         : (zatom)
                              :
(the number of atoms)         : No. of atoms in SUPERCELL, not in UNIT cell
0                             : (nhk) If zero, atomic positions are read from
                              :       &#39;CONFIGURATION_FILE&#39;.
                              :
(position file)               :
&#39;control/IN.CONFIG&#39;           :
 2                            : 1:scaled, 2:real coordinates
 1                            : (keyword)
(end)                         :
==============================:=======================================
(atomic number)               :
  1.0                         : (zatom)
                              :
(the number of atoms)         : No. of atoms in SUPERCELL, not in UNIT cell
0                             : (nhk) If zero, atomic positions are read from
                              :       &#39;CONFIGURATION_FILE&#39;.
                              :
(position file)               :
&#39;control/IN.CONFIG&#39;           :
 2                            : 1:scaled, 2:real coordinates
 2                            : (keyword)
(end)                         :
==============================:=======================================
*end                          : end of setting *atoms
</pre></div>
</div>
<p>In fact, many of these parameters need not be defined for an
optimization run, but are included so that only two things need to be
changed to make this input file run a quantum molecular dynamics (QMD)
simulation. First and foremost, the ‘(how of it)’ parameter (ifmd) in
the *molecular dynamics section must be changed. Above, this parameter
is set to 1, which will execute an optimization run, but setting this
parameter to 3 (as shown below) will execute a QMD simulation in the NVT
ensemble (this can also be set to ‘2’ for the NVE ensemble or ‘4’ for
the NPT ensemble).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">molecular</span> <span class="n">dynamics</span>           <span class="p">:</span>
<span class="p">(</span><span class="n">how</span> <span class="n">of</span> <span class="n">it</span><span class="p">)</span>                   <span class="p">:</span>
   <span class="mi">3</span>                          <span class="p">:</span> <span class="p">(</span><span class="n">ifmd</span><span class="p">)</span>
                              <span class="p">:</span>   <span class="mi">0</span><span class="p">:</span><span class="n">non</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">optimization</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="n">NVE</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="n">NVT</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="n">NPT</span>
</pre></div>
</div>
<p>The other thing that must be changed is the input configuration file.
Usually, you will want to start a QMD simulation from the optimized
geometry. The optimized atomic positions are obtained after an
optimization run using the ‘pick_config.f90’ utility file (see section
7.2). One can either give the optimized geometry configuration file a
new name and update this in the (position file) parameter in the *atoms
section, or replace IN.CONFIG with the new geometry. Once the ‘(how of
it)’ parameter in the *molecular dynamics section and the input
configuration file is adjusted to the optimized geometry, the input file
is complete for execution of a standard QMD simulation.</p>
</div>
<div class="section" id="adding-parameters-to-in-param">
<h2>6.2 Adding parameters to IN.PARAM<a class="headerlink" href="#adding-parameters-to-in-param" title="Permalink to this headline">¶</a></h2>
<p>Here, we give an example of how to add input parameters to the basic
IN.PARAM file given above in section 6.1. As described in the beginning
of Section 5, the main input file is divided into sections corresponding
to different groups of input parameters. Sections start with
<code class="docutils literal notranslate"><span class="pre">*SECTION_NAME</span></code> and end with <code class="docutils literal notranslate"><span class="pre">*end</span></code>. If you would like to add a
parameter from a section that already exists in the input file, you main
simply add in the parameter in any position within the section (i.e.
after the <code class="docutils literal notranslate"><span class="pre">\*section</span></code> name and before the corresponding *end). In order
to add a new input parameter from a section that does not already exist
in the input file, you must add that section (i.e. add the
<code class="docutils literal notranslate"><span class="pre">\*SECTION_NAME</span></code> and <code class="docutils literal notranslate"><span class="pre">\*end</span></code> lines with your new parameter in between) along
with the parameter. You need not add all paramters in the newly added section. Any parameters in the section that are not included will simply
be set to their default values. In this section, we show an example for
altering the above IN.PARAM file in Section 6.1 to execute a
non-adiabtic QMD (NAQMD) simulation. In this case, we must add the
<code class="docutils literal notranslate"><span class="pre">\*TDDFT-MD</span></code> section (see section 5.3), as time-dependent DFT is required
to run a NAQMD simulation. NAQMD simulations involve exciting electrons
from lower lying energy bands to higher lying ones, which is defined in
the <code class="docutils literal notranslate"><span class="pre">\*TDDFT-MD</span></code> section shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>---(Input-parameter file for QXMD)---
                              :
*parallel                     :
(QM-nodes)                    :
  1  1  1                     : (npx, npy, npz)
(MD-nodes)                    :
  1  1  1                     : (md_npx, md_npy, md_npz)
*end                          :
                              :
                              :
*start(on/off)                :
(how of it)                   :
 .false.                       : (lstart) .true. = restart
*end                          :
                              :
                              :
*approximation for Exc        :
(approximation)               :
       2                      : (jgga) = 1:LDA, 2:GGA(PBE),
                              :
(DFT-D)                       : an empirical correction for the vdW interaction
 .true.                       : (ldftd) .true. = on, .false. = off
                              :
*end                          :
                              :
                              :
                              :
*SCF iterations               :
(global iterations)           :
     100                      : (iscfmx) maximum No. of global iterations
(tolerances)                  :
      3.0d-08                 : (tolpot) tolerance for total energy
      5.0d-08                 : (tolres) tolerance for average residual
*end                          :
                              :
*TDDFT-MD                     :
(how of it)                   :
 .true.                       : (ltddft) .true. = execute MD based on TDDFT
                              :
(FSSH)                        :
 .true.                       : (ltddft_fssh) .true. = FSSH, .false. = Ehrenfest
                              :
(FSSH-switch)                 :
 .true.                       : (lfssh_switch) .true.  = switching aveilable
                              :                .false. = cccupations are fixed
(FSSH-ground-state-SCF)       :
 .true.                       : (lfssh_gsscf) .true.  = SCF with the ground  state
                              :               .false. = SCF with the excited state
(FSSH-mixing charge)          : only for lfssh_gsscf = .true.
   0.8d0  0.13d0              : (aslh_fssh, bslh_fssh)
                  :
(time step)                   :
   0.04d0                     : (dttddft) time step in [Hartree a.u.] in TDDFT-FSSH
                              :
(restart)                     :
 .false.                      : (ltddft_start) .true. = restart
                              :
(occupations)                 : for lrtddft = .false.
    2                         : (nocc_change) # of occupations to be changed
   4   0.0  0.0              : (numband, occ_new) band index, occupations(up&amp;down)
   5   2.0  0.0              : (numband, occ_new) band index, occupations(up&amp;down)

*end                          :
                              :
*molecular dynamics           :
(how of it)                   :
   3                          : (ifmd)
                              :   0:non, 1:optimization, 2:NVE, 3:NVT, 4:NPT
(time step)                   :
   50.0d0   1000               : (dtmd, nstop) time step, total step
(temperature)                 : only for real dynamics (NVE-, NVT-, NPT-MD )
   300.d0                     : (treq) temperature in [K]
(check temperature)           :
  .false.                     : (liscale) .true. = Do it !
   25                         : (iscnum)  number of temperature check
   20                         : (iscstp)  skip step
                              :
(optimization)                : only for structural optimization (ifmd == 1 )
    2                         : (ioptmze)
                              :  -1: do not optimize atomic coordinates
                              :   0: Conjugate gradient
                              :   1: Projected velocity Verlet
                              :   2: Quasi-Newton method with BFGS formula
                              :
(stabilizer for quasi-Newton) : only for quasi-Newton method (ifmd==1 &amp; ioptmze==2)
   0.1d0                      : (gammamin)
                              :
(clear Hessian)               : only for quasi-Newton method (ifmd==1 &amp; ioptmze==2)
    0                         : (ibfgsclear) clear Hessian every ibfgsclear step
                              :           if ibfgsclear == 0, Hessian is not cleared.
                              :
(atomic stress &amp; energy)      : only for MD nodes
 .true.                       : (latomic) .true. = output atomic stress &amp; energy
                              : Note that nskip_atomic = ioskip
                              : When lstress = false, atomic stress is not output.
                              :
(tolerance)                   : tolerance for CG optimization (ifmd == 1 )
  1.d-07                      : (tol_energy) energy/atom in [a.u.]
  5.d-04                      : (tol_force ) max. force  in [a.u.]
                              :
(output data)                 : only for MD nodes
    1                         : (ioskip)  skip step
 .true.    1                  : (locoor, ioskipcoor) scaled coordinates
 .false.    1                  : (lovelo, ioskipvelo) scaled velocities
 .false.    1                  : (loforc, ioskipforc) scaled forces
*end                          :
------------------------------:---------------------------------------
*supercell                    :
(unit of length)              :
(ang)                         : (bohr) or (ang)
                              :
(lengths &amp; angles)            :
7.00d0, 7.00d0, 5.0d0         :  lengths of cell vectors
90.000,  90.000,  90.000  :  angles between cell vec. in [deg.]
*end                          :
                              :
*planewaves                   :
(unit of cutoff energy)       :
(ry)                          : (ry) or (hr) or (ev)
(for wavefunctions)           :
  30.0                        : (ecut)
(for electron density)        :
 250.0                        : (ecutdens)
(for soft part of density)    :
 70.0                         : (ecutsoft)
*end                          :
                              :
*electronic bands             :
(occupied bands)              :
      8                     : (noband)  No. of occupied bands
(empty bands)                 :
      2                     : (neband)  No. of empty bands
                              :           total No.= noband + neband
(broadening)                  :
       3    500.d0            : (lfermi) = 1:nonmetallic, 2:Fermi, 3:Gaussian,
                              :   lfermi(&gt;3):Methfessel &amp; Paxton, order=lfermi-3
                              : (tfermi) = electronic temp.(K), if metallic
*end                          :
                              :
------------------------------:---------------------------------------
*atoms                        :
(species)                     :
  2                           : (ntype) No. of atomic species
==============================:=======================================
(atomic number)               :
  8.0                         : (zatom)
                              :
(the number of atoms)         : No. of atoms in SUPERCELL, not in UNIT cell
0                             : (nhk) If zero, atomic positions are read from
                              :       &#39;CONFIGURATION_FILE&#39;.
                              :
(position file)               :
&#39;control/IN.CONFIG&#39;           :
 2                            : 1:scaled, 2:real coordinates
 1                            : (keyword)
(end)                         :
==============================:=======================================
(atomic number)               :
  1.0                         : (zatom)
                              :
(the number of atoms)         : No. of atoms in SUPERCELL, not in UNIT cell
0                             : (nhk) If zero, atomic positions are read from
                              :       &#39;CONFIGURATION_FILE&#39;.
                              :
(position file)               :
&#39;control/IN.CONFIG&#39;           :
 2                            : 1:scaled, 2:real coordinates
 2                            : (keyword)
(end)                         :
==============================:=======================================
*end                          : end of setting *atoms
</pre></div>
</div>
<p>Note that the *TDDFT_MD section can be inserted in between any two
sections. Also note that (check temperature) should be set to .FALSE.
for NAQMD runs. Otherwise, everything else in the IN.PARAM file for a
regular (adiabatic) QMD run may remain the same for an NAQMD run, albeit
with with *TDDFT-MD section added and set to .TRUE.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="util.html" class="btn btn-neutral float-right" title="Utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="param.html" class="btn btn-neutral" title="Input Parameters: IN.PARAM" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Subodh Tiwari &amp;&amp; Lindsay Bassman

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>